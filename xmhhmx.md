---
timezone: UTC+8
---

# mX1@0

**GitHub ID:** xmhhmx

**Telegram:** @hhh xxx

## Self-introduction

一起加油

## Notes

<!-- Content_START -->
# 2025-08-07

| 今日学习内容            |
| ----------------------- |
| MyFirstLayer2  剩余学习 |
| 行业赛道全览            |

## MyFirstLayer2

### 1 公链瓶颈

#### 1.1改进尝试

为了保证参与门槛足够低，比特币将全网同步的出块时间控制在 10 分钟，平均 TPS （每秒可处理交易笔数）仅有个位数。以太坊出块时间约 12 秒，平均 TPS 也仅有十几笔。这对比于传统 Web2 的经济活动来说，远远不够用

提高区块链性能的两个尝试：

- <u>增大单个区块的大小，容纳更多的交易</u>

	这样做会引起区块账本的快速膨胀，参与验证的机器性能要求越来越高，提高了参与门槛，导致整个网络去中心化程度和安全性渐渐降低。从 BTC 分叉出来的 BCH（Bitcoin Cash） 将区块大小从 1MB 提升至 32MB，BSV（Bitcoin Satoshi's Vision） 则是更激进地取消了区块大小上限，允许无限多的信息融入一个区块。

- <u>降低出块的时间，追求一定时间内出更多的块来处理更多的交易</u>

	这样对节点的网络条件提出了更高要求，提高了参与门槛。并且影响了全网数据同步的稳定性，因为物理上相隔较远的节点集群容易对最新的区块产生分歧，导致分叉。分叉链总需要竞争出新的最长链，抛弃其中的一条分支，导致过去一段时间内的许多交易被重写，这就是“区块重组”现象，Polygon 在 2023 年发生过 157 个区块的重组事件。

此外，还有一些公链试图用更激进的方式改善性能：

- <u>使用数量更少的超级节点通讯：</u>

	超级节点的性能更强大，网络带宽更好更稳定，因此彼此之间能实现超高速的通讯，但这显然降低了去中心化程度。如 Fanton 有 51 个共识节点，BSC、EOS、TRON 则仅有 21 个超级节点。

- <u>用特殊的共识机制提升性能：</u>

	共识机制决定了全网节点对出块方式如何达成共识，一些特殊的机制也许可以提高出块速度，但共识机制越复杂，就对机器性能要求越高，也更容易出现单点故障导致整个系统出错。如 Solana，全网节点依赖随机选出的单个 Leader 节点来协调，因此获得了极高的理论 TPS 上限，但对节点性能要求变得非常高，并多次发生全网宕机的安全性事故。

目前高性能公链的探索成果，普遍获得了将 TPS 提升至 100 ~ 1000 的成绩，但共识节点数量也降低为几十个至一千多个不等。对比于以太坊分布全球的近万个共识节点 ，高性能公链在性能提高了一两个数量级的同时，去中心化程度也下降了一两个数量级。



#### 1.2 区块链三难困境

由于区块链的底层特性，存在一个不可能三角悖论。区块链不可能三角（Blockchain Trilemma）是指在设计区块链系统时，存在三个目标之间的矛盾，这三个目标分别是去中心化、安全性和可扩展性（性能）

1. **去中心化**（Decentralization）：指的是在区块链系统中，所有的节点都具有相同的权力，没有单一的中心化权威节点进行控制。这个目标是区块链的核心特性，也是保证系统安全性和抗攻击性的基础。
1. **安全性**（Security）：指的是在区块链系统中，保证交易的真实性、完整性、不可篡改性和抗攻击性等方面的安全。这个目标是区块链系统的重要保障，也是确保系统可靠性和信任度的基础。
1. **可扩展性**（Scalability）：可扩展性即性能，指的是在区块链系统中，支持足够大量的交易、节点和用户等系统扩展。这个目标是区块链系统的重要需求，也是确保系统能够满足现实需求的基础。

这三个目标之间存在矛盾关系。例如，在追求更高的去中心化的情况下，需要所有节点都保存完整的区块链数据，但是这会导致系统的可扩展性降低。相反，在追求更高的可扩展性的情况下，需要牺牲一定的去中心化；还比如采用分片技术 [1] 来扩容，但是可能导致节点同步数据困难，更容易发生故障，导致安全性降低。

**高安全性和高可扩展性**

追求安全性和可扩展性（即性能），往往采用少数超级节点进行通讯，超级节点拥有更强的性能和更好的网络环境，彼此之间能实现超高速的通讯。但参与门槛过高，牺牲了去中心化程度。

代表区块链：BSC、EOS、TRON 等区块链采用了少数高性能节点维护网络，仅有 21 个超级节点进行记账。

**高可扩展性和高去中心化**

追求可扩展性（即性能）和去中心化程度，为保证去中心化采用了较多验证节点，为了追求性能提高了出块速度，或采用了特殊的共识机制。但提高出块速度容易导致大规模区块重组，更复杂的共识机制容易导致全网宕机等安全事故，牺牲了安全性。

代表区块链：Polygon 在 2023 年发生了 157 个区块的大规模重组；Solana 多次出现全网宕机的事故。

**高去中心化和高安全性**

追求去中心化程度和安全性，采用更多的节点和更公平的出块方式，值得信赖。但为了允许低性能节点参与验证，协调全球网络延迟，导致每秒可处理的交易数较低，牺牲了性能。

代表区块链：BTC、ETH 追求了极致的安全可靠和去中心化，但处理交易的速度较低，BTC 约为 7 笔/秒，ETH 约为 10 - 20 笔/秒。



#### 1.3 Layer 2

事实上，有一种方法可以克服区块链三难困境。而工程实践上，我们可以通过增加层级的方式来优化三者的矛盾，增加层级实现了业务解耦，降低了原先层级的负担。

增加第二层网络（Layer 2 ），来分摊一层网络（Layer 1）的负担，达到扩容的目的。

> Layer 2 即二层网络，是在一层网络的基础上搭建的，用各种技术手段帮助底层公链扩容的解决方案



### 2 Layer 2发展史

#### 2.1 状态通道（State channel）

> 假设 Alice 经常在一家咖啡店消费，如果每次买一杯 5 美元的咖啡，都需要支付 0.5 美元的手续费，这也太痛苦了。那么假如 Alice 和咖啡店能达成共识，每次买咖啡时付给咖啡店一张签了名的欠条，一段时间后咖啡店攒了足够多的欠条，将欠条算好总金额一次性兑现，这样交易成本就可以大幅降低，对双方都有利。这种思路就是最早的二层网络，也就是状态通道的原理。

**状态通道** 是一种区块链扩容技术，允许用户在链下进行高频、低成本的交互，仅在开启和关闭通道时与区块链交互，从而实现近乎即时、零摩擦的交易。状态通道使用了**多签技术** [1]，允许两个个体之间提前存入一笔资金锁定在智能合约中，建立一个内部通道，然后双方可以在通道内进行多笔小额转账，速度极快，成本极低，再在一段时间后用转账证明一次性提款。状态通道也是比特币的 Lightning Network（闪电网络），以太坊的 Raiden Network（雷电网络）背后的底层技术。

> [1] 多签技术（Multi-sig）：即多重签名技术，是指需要多个授权方共同授权才能完成交易，提高了交易的安全性和可靠性。如公司财库的资金要求三人之中的至少两人签名（2/3）才能动用，状态通道中则要求同时拥有双方的签名（2/2）才能生效，多签也允许出现更多 n/m 的授权条件。



> **1. 核心原理**
>
> **(1) 基本流程**
>
> 1. **开启通道**：
> 	- 双方将资金锁定在链上的智能合约中（如存入 10 ETH）。
> 	- 生成初始状态（如 Alice: 6 ETH，Bob: 4 ETH），并签名确认。
> 1. **链下交易**：
> 	- 双方通过签名消息更新状态（如 Alice 转 1 ETH 给 Bob → Alice:5, Bob:5）。
> 	- **无需矿工/验证者**，交易即时生效。
> 1. **关闭通道**：
> 	- 将最终状态提交到链上，合约根据最新状态分配资金。
> 	- 若有争议（如一方提交过期状态），可挑战并惩罚作弊者。
>
> **(2) 技术关键点**
>
> - **多签名验证**：每次状态更新需双方签名。
> - **时间锁（Timelock）**：防止旧状态被恶意提交。
> - **欺诈证明（Fraud Proof）**：允许诚实方在争议期举证。
>
> **2. 为什么需要状态通道？**
>
> |     **问题**     |   **状态通道解决方案**   |
> | :--------------: | :----------------------: |
> | 链上交易慢且昂贵 | 链下交易零成本，即时确认 |
> | 区块链吞吐量有限 |    支持无限次链下交互    |
> |     隐私性差     | 交易细节仅在参与者间传递 |
>
> ------
>
> **3. 典型应用场景**
>
>  **(1) 高频微支付**
>
> - **案例**：
> 	- 按秒计费的视频流服务（如每小时支付 0.001 ETH）。
> 	- 游戏内道具实时交易。
>
>  **(2) 链下投票与治理**
>
> - **案例**：
> 	- DAO 成员在通道内频繁投票，最终结果上链。
>
> **(3) 隐私保护交易**
>
> - **案例**：
> 	- 双方链下协商价格，仅公开最终交易。
>
> **4.优缺点**
>
>  **✅ 优点**
>
> - **零延迟**：交易即时完成。
> - **零 Gas 费**：链下交互无需付费。
> - **隐私性**：交易细节不上链。
>
> **❌ 缺点**
>
> - **通道管理复杂**：需预先锁定资金。
> - **适用性有限**：仅适合固定参与者间的交互。
> - **流动性要求**：长期占用资金。



状态通道技术本质上是使用了**中心化的节点**，用户在链上质押一笔较大额的资金，然后在链下用签了名的“欠条”进行付款，积攒了一定量的“欠条”之后，任何一方都可以选择关闭通道进行结算。链上的智能合约只认可同时拥有双方签名的转账信息，Alice 和咖啡店都拥有自己的签名，再加上“欠条”上对方的签名，才能凑齐签名**通过多签验证**，因此无法提取不属于自己的资金。

但这样做产生了 2 个新的问题：

1. Alice 和咖啡店之间攒“欠条”的约定仅适合于最简单的转账交易，去中心化金融要实现的交易比转账复杂得多，那么**想要实现更复杂的交易要怎么办呢**？为了解决这个问题，引出了**侧链**方案。
1. Alice 可以给咖啡店发送资金，若超市与咖啡店有通道，也可以借助咖啡店向超市发送资金，但是**如何给未参与雷电网络的个体发送资金呢**？这个问题，则引出了 **Plasma** 方案。



#### 2.2 侧链（Sidechain）

为了解决**状态通道无法执行复杂交易**的问题，侧链方案进入人们视野。

**侧链**可以理解为一条相对独立的区块链，它们往往采用与主链（一般是以太坊）类似的架构，方便主链上的项目迁移至侧链。

我们可以在主链的智能合约内锁定一定量的资产，然后在侧链上铸造等量资产，实现“原子交换”。用这种方式将资产存入侧链，在侧链上进行各种交易，然后在必要时转移回主链。



**侧链核心特性**

|   **特性**   |                        **说明**                         |
| :----------: | :-----------------------------------------------------: |
|  **独立性**  | 拥有自己的共识机制（如 PoA、PoS）、区块参数和智能合约。 |
| **双向锚定** |      资产可从主链锁定后映射到侧链，也能反向返回。       |
| **互操作性** |           通过桥接协议（Bridge）与主链通信。            |
|  **定制化**  |   可针对特定需求优化（如高TPS、低Gas费、隐私增强）。    |

侧链会进行一定的定制化，获得更高的性能，帮助主链分担交易压力。

- 采用 **POS** 共识机制（Proof of Stake），大幅提高了出块速度以达到扩容的目的。如 Polygon 侧链，将出块时间缩短至 2 秒。
- 采用 **POA** 共识机制（Proof of Authority），用更少的经过授权的超级节点进行通信，以实现侧链上的超高性能。如负责游戏资产交易的 Ronin 侧链，因游戏内的 NFT 资产本就比较中心化，所以这种更中心化的方案也可以接受。



**侧链的工作原理**

**(1) 资产跨链流程（以以太坊 ↔ Polygon 为例）**

1. **存款（主链 → 侧链）**
	- 用户将 ETH 存入主链的桥合约，合约锁定资产并生成证明。
	- 侧链验证证明后，在侧链上 mint 等量的封装资产（如 WETH）。
1. **提款（侧链 → 主链）**
	- 用户销毁侧链的 WETH，提交销毁证明到主链桥合约。
	- 主链合约验证后解锁原始 ETH。

**(2) 共识机制差异**

- **主链**：通常采用高安全共识（如以太坊的 PoS）。
- **侧链**：可能使用更高效的共识（如 Polygon PoS 链的 Bor 共识）。



**为什么需要侧链？**

|      **主链瓶颈**       |               **侧链解决方案**               |
| :---------------------: | :------------------------------------------: |
| 低TPS（如以太坊15 TPS） |  侧链可达数千 TPS（如 Polygon 7,000 TPS）。  |
|         高Gas费         | 侧链交易成本极低（如 BSC 的 $0.01 交易费）。 |
|        功能限制         |  侧链可定制模块（如隐私交易、游戏专用链）。  |



 **典型侧链项目**

|      **侧链**      | **锚定主链** |         **特点**         |    **用例**    |
| :----------------: | :----------: | :----------------------: | :------------: |
|  **Polygon PoS**   |    以太坊    |      高TPS，EVM兼容      |   DeFi、NFT    |
|  **Gnosis Chain**  |    以太坊    | 注重去中心化，xDai 合并  |   支付、DAO    |
| **Liquid Network** |    比特币    |  联邦桥接，支持机密交易  | 比特币快速结算 |
|     **Ronin**      |    以太坊    | Axie Infinity 游戏专用链 |     GameFi     |



**侧链的安全风险**

**(1) 桥接攻击**

- **案例**：2022 年 Ronin 桥被盗 6.25 亿美元（私钥泄露）。
- **防御**：使用多重签名、零知识证明桥（如 zkBridge）。

**(2) 共识中心化**

- 部分侧链（如 BSC）由少数节点控制，可能被操纵。

**(3) 资产锚定失效**

- 若桥合约漏洞导致双向锚定断裂，侧链资产可能脱钩。



侧链通过 **牺牲部分主链安全性** 换取高性能和低成本，是区块链生态的重要扩容手段。用户在使用时需权衡**效率、成本与风险**，优先选择经过时间验证的侧链和桥接协议。



#### 2.3 Plasma

随着状态通道和侧链方案在实践中暴露出不足，Plasma 方案被提出并得到重视，它解决了前面两者暴露出的两个问题：

- **无法给未参与的个体发送资金**：未加入 Plasma 链的账户也可以收到资金，然后自行提取到 Layer 1。
- **无法继承 Layer 1 安全性**：Plasma 定期向主链提交信息，以继承 Layer 1 安全性。

**Plasma** 是以太坊创始人 **Vitalik Buterin** 和 **Joseph Poon** 在 2017 年提出的一种 **区块链扩容方案**，旨在通过构建多层链下结构（“子链”），将大部分交易从<u>主链（如以太坊）卸载到子链上处理</u>，从而显著提升吞吐量并降低交易成本。尽管后期因技术复杂性被 Rollup 取代，但 Plasma 的设计思想仍对 Layer2 发展影响深远。



**Plasma 的核心思想**

 **(1) 分层结构**

- **主链（Root Chain）**：以太坊等底层区块链，负责最终结算和争议仲裁。
- **子链（Plasma Chain）**：独立的链下区块链，处理高频交易，定期向主链提交状态承诺（Merkle Root）。

**(2) 关键机制**

- **状态承诺**：子链将交易批量打包后，生成 Merkle Root 并提交到主链。
- **欺诈证明（Fraud Proof）**：若子链作恶（如篡改交易），用户可提交证明至主链，触发惩罚和状态回滚。
- **资金退出（Exit）**：用户需通过主链的“退出游戏”机制安全取回资金。



**Plasma 的工作原理**

**(1) 存款（主链 → Plasma 链）**

1. 用户将资产（如 ETH）锁定在主链的 Plasma 智能合约中。
1. Plasma 链生成对应的资产凭证（如 1:1 映射的代币）。

**(2) 链下交易（Plasma 链内）**

- 用户在 Plasma 链上自由交易（如转账、支付），无需主链确认。
- 子链区块生产者（Operator）定期将交易打包，并提交 Merkle Root 到主链。

**(3) 提款（Plasma 链 → 主链）**

1. 用户发起提款请求，启动 **7天挑战期**（类似 Optimistic Rollup）。
1. 若无争议，主链释放锁定的资产；若有欺诈，提交证明取消提款。



**Plasma 的优缺点**

**✅ 优点**

- **高吞吐量**：交易在子链处理，主链仅存储压缩数据。
- **低成本**：Gas 费由子链承担，主链仅需极低开销。
- **安全性继承**：依赖主链的**欺诈证明机制**确保资金安全。

 **❌ 缺点**

- **退出延迟**：提款需等待挑战期（7天），流动性受限。
- **数据可用性问题**：**<u>若子链运营商隐藏数据，用户无法构造欺诈证明。</u>**
- **通用性差**：难以支持复杂智能合约（仅适合支付等简单逻辑）。



**为什么 Plasma 逐渐被淘汰？**

1. **数据可用性问题**：用户无法获取子链完整数据时，无法挑战无效交易。
1. **用户体验差**：提款延迟长，且需主动监控欺诈。
1. **Rollup 的崛起**：
	- **ZK Rollup** 通过零知识证明解决数据问题。
	- **Optimistic Rollup** 保留欺诈证明但强制数据上链，平衡安全与成本。



> 默克尔树利用了哈希算法（Hash Algorithm），每个子节点的内容，都影响着上一个节点的哈希值。因此保存在默克尔树内的数据，若被改变了哪怕一个字符，都将导致上方一连串节点的哈希值改变，最终传导至默克尔树的根部也发生改变。任何人都可以自行运算哈希算法来检查计算出的哈希值与公开的哈希值是否对应，以此确认内容是否被篡改。



#### 2.4 Rollup

虽然 Plasma 最终未能大规模使用，但它的一些理念在后续的 Layer 2 方案中被吸收和发展。

既然困扰 Plasma 最大的问题是**数据可用性**，也就是监督者不容易获取交易数据以进行检验的问题。那我们如果不仅仅上传一个根证明，而是把必要的关键数据通通上传至 Layer 1 ，是不是就解决了这个棘手问题呢？

这个思路带来了目前最具可行性的 Layer 2 扩容方案： Rollup。Rollup 意为“打包”，也就是将一段时间内发生的交易先进行压缩，再进行打包，然后周期性地上传至主网。目前主流的 Rollup 方案分为两大路线，分别为 **Optimistic Rollup**（乐观的 Rollup）与 **Zero-knowledge Rollup**（零知识证明的 Rollup）。

- Optimistic Rollup：OP-Rollup 是将一段时间内的所有交易细节全部压缩打包，定期发送至 Layer 1。这种机制乐观地相信大部分交易都是诚实的，继承了 Plasma 挑战期和欺诈证明机制。
- Zero-knowledge Rollup：ZK-Rollup 一般是将一段时间内的交易计算完成后，将状态变化的结果压缩打包，并附上交易已经在 Layer 2 被正确执行的零知识证明，定期发送至 Layer 1。用零知识证明代替监督者，依赖数学而非验证者（Rely on Math, not Validators）。



**Rollup 的核心思想**

**(1) 链下执行 + 链上验证**

- **链下**：交易在 Rollup 链（Layer2）上执行。
- **链上**：交易数据（或有效性证明）提交到主链（Layer1），确保安全性。

**(2) 数据压缩**

- Rollup 将多笔交易压缩为 **单个批次**，减少链上存储开销。
- 例如：1000 笔交易 → 1 个 Rollup 区块 → 1 笔主链交易。



**Rollup 的两种类型**

**(1) Optimistic Rollup（乐观汇总）**

- **假设交易合法**，默认不验证，依赖 **欺诈证明（Fraud Proof）** 争议机制。
- **特点**：
	- 兼容 EVM（如 Arbitrum、Optimism）。
	- 提款需等待 **7天挑战期**。
	- 成本低，适合通用智能合约。

**工作流程**：

1. 交易在 Layer2 执行。
1. 排序器（Sequencer）将交易数据（Calldata）提交到主链。
1. 若有欺诈，验证者在挑战期内提交证明，回滚错误状态。

**(2) ZK Rollup（零知识证明汇总）**

- 每批交易生成 **零知识证明（ZK-SNARK/STARK）**，主链即时验证。
- **特点**：
	- 无需挑战期，提款即时到账。
	- 证明生成计算量大，早期难兼容 EVM（现 zkEVM 已突破）。
	- 隐私性更强（可隐藏交易细节）。

**工作流程**：

1. 交易在 Layer2 执行。
1. 生成有效性证明（Proof）并提交到主链。
1. 主链验证证明后，更新状态。



**Rollup 的优缺点**

**✅ 优点**

- **高扩展性**：吞吐量提升百倍。
- **安全性**：依赖主链验证，抗审查。
- **低成本**：Gas 费仅为链上的 1/10~1/100。

**❌ 缺点**

- **Optimistic 的延迟**：提款需等待 7 天（可通过流动性提供商缓解）。
- **ZK 的硬件需求**：证明生成需要高性能服务器。
- **中心化风险**：排序器可能被垄断（逐步去中心化中）。



> ### **零知识证明（Zero-Knowledge Proof, ZKP）详解**
>
> **零知识证明** 是一种密码学技术，允许一方（证明者）向另一方（验证者）**证明某个陈述的真实性**，而无需透露任何额外信息。其核心思想是：**“我知道一个秘密，但我不会告诉你秘密是什么”**。
>
> 在区块链领域，ZKP 是隐私保护（如 Zcash）和扩容（如 ZK Rollup）的核心技术。
>
> #### **1. 零知识证明的三大核心特性**
>
> 1. **完备性（Completeness）**：
> 	- 如果陈述为真，诚实验证者一定会被说服。
> 1. **可靠性（Soundness）**：
> 	- 如果陈述为假，作弊的证明者无法欺骗验证者。
> 1. **零知识性（Zero-Knowledge）**：
> 	- 验证者除了“陈述为真”外，无法获取任何其他信息。
>
> #### **2. 经典类比：洞穴寓言**
>
> 假设有一个环形洞穴，中间有一道需要密码才能打开的门。
>
> - **证明者**知道密码，想向**验证者**证明这一点，但不想泄露密码。
> - **过程**：
> 	1. 验证者站在洞口，随机要求证明者从左侧（A）或右侧（B）进入。
> 	1. 证明者无论从哪边进入，都能用密码开门并从另一侧出来。
> 	1. 重复多次后，验证者确信证明者确实知道密码，但始终不知道密码是什么。
>
> #### 3. 零知识证明的两种主要类型
>
> **(1) 交互式零知识证明（Interactive ZKP）**
>
> - 需要多轮通信（如洞穴寓言中的多次进出）。
> - **缺点**：效率低，不适合区块链。
>
> **(2) 非交互式零知识证明（Non-Interactive ZKP, NIZK）**
>
> - 证明者生成单次证明，验证者可随时检查。
> - **区块链常用**：如 ZK-SNARKs、ZK-STARKs。
>
> #### **4. 区块链中的 ZKP 技术**
>
>  **(1) ZK-SNARKs（简洁非交互式知识论证）**
>
> - **特点**：
> 	- 证明体积小（约 200 字节），验证速度快。
> 	- 需要“可信设置”（Trusted Setup），存在潜在风险。
> - **应用**：
> 	- **Zcash**（隐私转账）。
> 	- **zkSync**（ZK Rollup）。
>
>  **(2) ZK-STARKs**
>
> - **特点**：
> 	- 无需可信设置，抗量子计算。
> 	- 证明体积较大（约 100 KB），但验证速度仍快。
> - **应用**：
> 	- **StarkNet**（以太坊 Layer2）。
>
> **(3) Bulletproofs**
>
> - **特点**：
> 	- 无需可信设置，适合范围证明（如 Confidential Transactions）。
> - **应用**：
> 	- **Monero**（隐私币）。
>
> #### **5. 零知识证明的区块链应用**
>
> **(1) 隐私保护**
>
> - **匿名交易**：Zcash 使用 ZK-SNARKs 隐藏发送方、接收方和金额。
> - **身份验证**：证明年龄 >18 岁，而无需透露出生日期。
>
>  **(2) 扩容（ZK Rollup）**
>
> - <u>将数千笔交易打包，生成 ZKP 证明提交到主链，验证者只需检查证明即可确认有效性。</u>
> - **代表项目**：zkSync、StarkNet、Scroll。
>
> **(3) 去中心化存储验证**
>
> - 证明文件已正确存储，而无需下载全部数据（如 Filecoin）。
>
> #### **6. 零知识证明的优缺点**
>
> **✅ 优点**
>
> - **隐私性**：隐藏敏感数据（如交易详情）。
> - **扩展性**：减少链上计算负担（如 ZK Rollup）。
> - **安全性**：数学上无法伪造证明。
>
> **❌ 挑战**
>
> - **计算密集型**：生成证明需要高性能硬件。
> - **可信设置（ZK-SNARKs）**：初始参数若泄露，可能伪造证明。
> - **开发门槛高**：需要密码学专业知识。



#### 2.5 Layer 2 对比

**核心特性对比**

|   **维度**   |     **State Channel**     |    **Sidechain**     |    **Plasma**     |        **Rollup**        |
| :----------: | :-----------------------: | :------------------: | :---------------: | :----------------------: |
|  **安全性**  |       依赖最终结算        |     依赖侧链共识     | 依赖主链欺诈证明  |      继承主链安全性      |
| **交易速度** |       即时（链下）        | 较快（依赖侧链性能） | 较快（链下执行）  |     较快（链下执行）     |
|   **成本**   | 链下免费，仅开/关通道付费 |   低（侧链Gas费）    |       极低        |     极低（数据压缩）     |
| **去中心化** |  需预存资金，参与者固定   |   可变（PoA/PoS）    |    依赖运营商     |       逐步去中心化       |
| **数据存储** |      仅最终状态上链       |     独立链上存储     | 仅提交Merkle Root | 交易数据全上链（Rollup） |
| **适用场景** |  高频小额支付（如游戏）   | 独立生态（如GameFi） | 简单支付/资产转移 |       通用智能合约       |



**工作原理对比**

**(1) State Channel（状态通道）**

- **流程**：
	1. 双方锁定资金在主链。
	1. 链下无限次交易（仅双方签名）。
	1. 最终结算状态上链。
- **例子**：比特币闪电网络、以太坊的Raiden Network。

**(2) Sidechain（侧链）**

- **流程**：
	1. 资产通过桥锁定在主链，映射到侧链。
	1. 侧链独立运行（自有共识机制）。
	1. 提款时反向桥接回主链。
- **例子**：Polygon PoS链、Ronin（Axie Infinity侧链）。

 **(3) Plasma**

- **流程**：
	1. 资产锁定在主链Plasma合约。
	1. 子链处理交易，定期提交Merkle Root到主链。
	1. 提款需挑战期（防欺诈）。
- **例子**：早期OMG Network（已转向Rollup）。

 **(4) Rollup**

- **流程**：
	1. 交易在链下执行并压缩。
	1. 数据批量提交到主链（Optimistic需欺诈证明，ZK需有效性证明）。
- **例子**：Optimism（OP）、Arbitrum、zkSync。



**安全性对比**

|     **方案**      |  **安全模型**  |            **主要风险**             |
| :---------------: | :------------: | :---------------------------------: |
| **State Channel** | 依赖参与者诚实 |      对手方离线时资金可能锁定       |
|   **Sidechain**   |  依赖侧链共识  |  桥接攻击（如Ronin被盗6.25亿美元）  |
|    **Plasma**     |  主链欺诈证明  | 数据不可用性问题（运营商隐藏数据）  |
|    **Rollup**     |  继承主链安全  | Optimistic的7天延迟，ZK的证明中心化 |



**优缺点总结**

|     **方案**      |          **优点**          |            **缺点**            |
| :---------------: | :------------------------: | :----------------------------: |
| **State Channel** | 零延迟，零Gas费，隐私性好  |   仅限固定参与者，需预存资金   |
|   **Sidechain**   |      高性能，灵活定制      |    安全性依赖侧链，桥接风险    |
|    **Plasma**     |      高吞吐量，低成本      |   退出延迟长，不支持复杂逻辑   |
|    **Rollup**     | 继承主链安全，支持智能合约 | Optimistic有延迟，ZK开发门槛高 |



**未来趋势**

- **Rollup 主导**：Optimistic 和 ZK Rollup 成为以太坊扩容主流。
- **State Channel 小众化**：仅用于特定场景（如微支付）。
- **Sidechain 专用化**：游戏、社交等垂直领域。
- **Plasma 淘汰**：被 Rollup 取代（因数据可用性问题）。



### 3 Rollup详情

#### 3.1 如何压缩

以 OP-Rollup 的为例，我们要向 Layer 1 上传一段时间内的所有交易详情，如果不对这部分数据进行高度压缩，那分担负载的效果就非常小了。我们以单笔交易为例，它身上其实有许多可改进的空间。

比如一笔常见的转账交易，它的原数交易数据可能是以下这样的：

**4232f461**000000000000000000000000**7ea2be2df7ba6e54b1a9c70676f668455e329d29**000000000000000000000000**d548a5e31de2b4c2681a58a3be5302abcae4bc57**00000000000000000000**000000000000000000000000000000000000000186a0**

（**Method ID** / 零填充[1] / **代币合约地址** / 零填充 / **收款的账户地址** / 零填充 / **提币数量**）

>  [1]零填充：之所以要填充零占用空间，是因为以太坊中的交易数据是固定长度编码的，比如 Method ID 占用 128 位（32 个十六进制字母），地址和金额占用 256 位（64 个十六进制字母），不够长的信息字段需要填充 0 以保持数据对齐和一致性。

<u>**原始交易数据可以通过以下手段压缩：**</u>

1. 用**科学计数法**把转账数量压缩成 64 位数据，并删除不必要的 0。（数量的精度会略微下降，但实践中影响不大）
1. 调用的方法如果很常见，可以删除所调用的 Method ID，因为如“转账一笔 ERC20 [3] 代币”的交易，可以通过交易内容的特征推测
1. 常用行为设置绿色通道（Helper ID）：大部分发送代币的行为都是如 USDC、WETH 等常用代币，可以用更短的一个 Helper ID，来表示调用方法是“发送”，发送的代币是“USDC”这两个信息。
1. 登记一个“电话簿”，记录收款人地址，将 40 位的地址压缩为第 XXX 页的第 X 个地址。
1. 如果发送的是 ETH，连 Helper ID 都可以省掉。



最终我们需要上传至 Layer 1 的数据从一段非常长的信息

**4232f461**000000000000000000000000**7ea2be2df7ba6e54b1a9c70676f668455e329d29**000000000000000000000000**d548a5e31de2b4c2681a58a3be5302abcae4bc57**00000000000000000000**000000000000000000000000000000000000000186a0**

变为了

**059c57**0186a0

（**收款账户“电话簿”编号** / 提币数量）



**数据压缩过程**

1. **原始状态**

<u>原始交易数据未经压缩</u>

> **4232f461**000000000000000000000000**7ea2be2df7ba6e54b1a9c70676f668455e329d29**000000000000000000000000**d548a5e31de2b4c2681a58a3be5302abcae4bc57**00000000000000000000**000000000000000000000000000000000000000186a0**

（Method ID / 零填充 / 代币合约地址 / 零填充  / 收款的账户地址 / 零填充 / 提币数量）

2. **压缩状态1**

<u>用**科学计数法**把转账数量压缩成 64 位数据，并删除不必要的 0。（数量的精度会略微下降，但实践中影响不大）</u>

> **4232f461**7ea2be2df7ba6e54b1a9c70676f668455e329d29**d548a5e31de2b4c2681a58a3be5302abcae4bc57**0186a0

（Method ID / 代币合约地址 / 收款的账户地址 / 提币数量）

3. **压缩状态2**

<u>调用的方法如果很常见，可以删除所调用的 Method ID，因为如“转账一笔 ERC20 [3] 代币”的交易，可以通过交易内容的特征推测</u>

> **7ea2be2df7ba6e54b1a9c70676f668455e329d29**d548a5e31de2b4c2681a58a3be5302abcae4bc57**0186a0**

（代币合约地址 / 收款的账户地址 / 提币数量）

4. **压缩状态3**

<u>常用行为设置绿色通道（Helper ID）：大部分发送代币的行为都是如 USDC、WETH 等常用代币，可以用更短的一个 Helper ID，来表示调用方法是“发送”，发送的代币是“USDC”这两个信息。</u>

> **0000ee**d548a5e31de2b4c2681a58a3be5302abcae4bc57**0186a0**

（Helper ID / 收款的账户地址 / 提币数量）

5. **压缩状态4**

<u>登记一个“电话簿”，记录收款人地址，将 40 位的地址压缩为第 XXX 页的第 X 个地址。</u>

> **0000ee**059c01**0186a0**

（Helper ID / 收款账户“电话簿”编号 / 提币数量）

6. **压缩状态5**

<u>如果发送的是 ETH，连 Helper ID 都可以省掉。</u>

> **059c01**0186a0

（收款账户“电话簿”编号 / 提币数量）



Layer 1 存储数据的成本是非常高昂的，Layer 2 的执行成本绝大部分的都消耗在了这一步，因此压缩需要上传的数据上可以显著降低 Layer 2 整体的交易成本。



#### 3.2 进一步压缩

数据压缩是个远早于区块链就存在的技术，除了前面对交易的定制化压缩之外，还有许多压缩算法能帮助进一步压缩数据空间。

比如我们生活中往往都接触过 zip、rar、7z 压缩包，它们就是使用了压缩算法将各种文件的体积减小。 Optimism 的 Zlib 压缩算法、 Arbitrum 的 Brotli 压缩算法都能起到类似的作用。



#### 3.3 Optimistic Rollup

Optimistic Rollup 是“乐观的打包”，它假设绝大部分的参与者都是诚实的，允许一批数量较少的验证者节点（Validator），对交易进行收集、排序、验证。同时还设置了挑战者的角色（Challenger），其职责是监督验证者提交的信息是否诚实。

OP-Rollup 会定期向主网上传两种数据：

- 状态根（State Root）: 状态根可以快速确认 Layer 2 小账本的内容是否被篡改。
- 压缩后的全部交易数据：包含各种交易细节，比如交易附带的“用户签名”。

虽然上传了近段时间的全部交易详情，但以太坊主网并不负责直接验证这些交易，只起到一个公示的作用。



与 Plasma 类似，OP-Rollup 也使用默克尔树的形式保存了一个“小账本”，记录了全体账户的所有状态（账户余额）。如果我们相信目前的交易验证者（Validator）都是诚实的，那么状态根能快速确认当前 Layer 2 的小账本记录的内容是否被篡改，确保安全性。

反之，假如我们对目前的交易合法性产生质疑，任何第三方都可以在主网获取最近一段时间内所有交易的副本，重新验证之后，将自己验证的结果与 Layer 2 的小账本的记录做对比，确认小账本上的记录均为合法。如果发现作恶，挑战者就可以在 Layer 1 提交欺诈证明来改写 Layer 2 的状态。挑战成功后，不诚实的验证者将受到惩罚，挑战者将获得奖励。同时，受影响的交易将被回滚 [1]，进行重新验证。

> [1] 回滚的影响范围取决于具体 Layer 2 的设计机制。有些选择仅回滚无效的交易；有些选择将受影响的区块变为孤块，从未受影响的区块后继续，这将导致一段时间内的交易都将被回滚，进行重新验证；有些选择用多轮挑战等其他手段，缩小需要回滚的范围。

这个过程中，负责监督的挑战者（Challenger）是直接与 Layer 1 的智能合约交互的，一层对二层的状态有着最终裁决权。



这种设计之下，即使只有一个诚实的挑战者，也足以确保整个 Layer 2 的交易安全。不过代价是 OP-Rollup 必须提供一个退出窗口期，让挑战者有时间去检验并提交欺诈证明，因此使用官方桥从 OP-Rollup 网络提款往往需要 7 - 14 天的等待期。

OP-Rollup 的逻辑简单易懂，而且上传了全部交易细节，因此对 EVM [2] （以太坊虚拟机）的兼容性也非常好，很有利于落地实施。但漫长的挑战期实在是太痛苦了，有办法解决**退出等待时间过长的问题**吗？

> [2] EVM 即 Ethereum Virtual Machine，是以太坊中智能合约的执行环境。虚拟机（Virtual Machine）是通过软件模拟的具有完整硬件系统功能的、运行在隔离环境中的完整计算机系统。开发者不必关心底层细节如何实现，只要在以太坊虚拟机中开发，就能确保代码执行环境的一致性。



#### 3.4 Zero-Knowledge Proof

造成漫长等待期的原因，是因为 OP-Rollup 需要人的参与（挑战者扮演的角色）。如果能让整个过程不需要人的参与，只需要算法的参与，那就完美了。

**零知识证明**是指向他人证明某个命题为真，但又不透露“该命题为真”之外的任何信息。例如，有一个环形的长廊，在走廊中间某处有一道安装了密码锁的门。如果 A 要向 B 证明自己拥有该门的密码，无需向 B 展示自己打开密码锁的过程。只需要让 B 看着 A 从入口进入走廊，然后又从另一侧的出口走出走廊，就可以完全证明 A 拥有密码，同时免除了暴露密码的风险。



**零知识证明具备以下性质**：

1. 完备性（Completeness）：若命题为真，任何证明者可以向验证者提出令人信服的证据，即“真的可被验证”。
1. 可靠性（Soundness）：若命题为假，则不存在不诚实的证明者能骗过验证者，即“假的会被发现”。
1. 零知识性（Zero-knowledge）：证明某个命题为真，但又不透露“该命题为真”之外的其他任何信息。

工程实践上我们还要求零知识证明的算法拥有以下性质：

1. 简洁性（Succinctness）：证明很小且验证速度快。
1. 零知识（Zero Knowledge）：可以隐藏计算的输入信息。



ZK-Rollup 会周期性向主网上传 3 种数据：

- 状态根：状态根可以快速确认 Layer 2 小账本的内容是否被篡改。
- 交易数据：经过压缩和聚合的交易数据，例如将多个交易合并为一批次的状态变化结果。通过使用零知识证明保证交易的安全性，可以舍弃一些不必要的信息，例如前面提到的“用户签名”。
- 有效性证明：即零知识证明，让 Layer 1 的智能合约在经过简单验证后，就能确认交易已经被正确执行。



ZK-Rollup 与 OP-Rollup 最大的不同，就在于 <u>Layer 1 是否对 Layer 2 上传的数据进行验证</u>。

ZK-Rollup 方案依靠 Layer 1 上的智能合约，用很小的代价检验 ZK Proof 的有效性，如果检验通过则表示这批交易已经被正确执行，那就更新状态。如果检验不通过，则拒绝这一批次的交易。

OP-Rollup 则完全将 Layer 1 当成了解决数据可用性的公告板，依赖挑战者的监督，两者的安全性和交易确认速度都会产生明显差异。

ZK-Rollup 的优点显而易见：

- 依靠数学而非验证者，安全性更有保障，并且确认时间更短。
- 更高的压缩率，让 Layer 2 的扩容上限更高。



#### 3.5 ZK 技术原理 STARK vs SNARK

<u>**本内容暂时无法理解**</u>

**ZK-Rollup 的基础组件**

ZK-Rollup 用了一些特定的数学工具，来实现在不透露原始输入数据的情况下确保交易已被正确执行，它通常包含以下主要技术：

- KZG 多项式承诺：因两个多项式最多拥有 n2 个交点，而定义域却存在极多的点，那么我们只需要检查有限的若干次，就能确信对方确实以正确的多项式进行了计算。若将信息编码在多项式中，则靠多次确认多项式在特定点上的输出结果，即可确认交易已被正确验证（确认过程原本是需要交互的，但可用其他方法变为非交互式）。
- 哈希算法：能将任意长度的数据映射为固定长度的哈希值，用于压缩证明。
- 椭圆曲线加密：可以将椭圆曲线上的两个点用难以预测的方式映射起来，用于构建证明系统。可用来进行一些复杂的证明，比如在不公开哈希值的情况下证明两个哈希相等。
- 随机数等其它组件：用于随机数来确认起始需要检查的点，并用类似“上一个哈希影响下一个哈希”的方式确认一连串需要检查的点，以确保检查点的随机性与非交互性。



##### **SNARK**

目前零知识证明主要有两种技术路线，SNARK 与 STARK。SNARK 出现更早，更加成熟，目前被更多的项目方采用。

SNARK：Succinct Non-Interactive Argument of Knowledge

1. 简洁（Succinct）：验证速度快于计算证明。
1. 非交互式（Non-Interactive）：无需证明者与验证者之间进行交互。如比特币的公私钥对也是一种零知识证明，但它要求私钥拥有者对一段文字进行签名才能证明自己拥有私钥，这需要发生一次交互。
1. 统计学上的可靠（Argument）：相对于数学上绝对的证明(即 100% 可靠)，实现了统计学上的可靠（如 99.99999999%）。
1. 包含信息（Knowledge）：可将某些信息编码进零知识证明中，如一笔交易已被正确执行。



##### **STARK**

STARK：Scalable Transparent Argument of Knowledge

1. 可扩展的（Scalable）：在进行大规模交易的证明时，验证时间仍然较短。
1. 透明的（Transparent）：随机数公开可验证，无需像 SNARK 一样设置初始可信环境。
1. 统计学上的可靠（Argument）：相对于数学上绝对的证明(即 100% 可靠)，实现了统计学上的可靠（如 99.99999999%）。
1. 包含信息（Knowledge）：可将某些信息编码进零知识证明中，如一笔交易已被正确执行。



对比两条技术路线，STARK 在 Layer 2 上处理大量交易时，其零知识证明生成速度和验证速度更快的特点将具有优势，并且具有抗量子性 [1]，无需初始可信环境 [2]，更加安全。而 SNARK 发展时间更久更成熟，将会更早取得应用。

SNARK 证明体积更小，并且随着技术发展，已经可以在升级后沿用最初的可信环境，在安全性上不会显著弱于 STARK。SNARK 与 STARK 的关系更像是 OP-Rollup 与 ZK-Rollup 之间的关系，前者可能更早落地，后者拥有更大潜力。

从底层技术路线去研究 ZK-Rollup 显得有点复杂了，**有更简单的方式去理解 ZK-Rollup 吗**？



> [1] 抗量子性指能够在量子计算机攻击下保证信息安全。传统的加密算法（如 RSA、DSA 和 ECC 等）可能在将来的大规模量子计算机上被有效地破解，因此需要使用新的抗量子密码学算法来替代，确保加密在未来的量子计算机时代仍然安全。
>
> [2] 初始可信环境是指在协议部署的最初，需要信任部署者诚实地部署了一个安全环境。比如参与部署的多个实体中，有一人销毁了自己的私钥，即可确认初始信息没有任何人能掌控。初始可信环境主要与随机数有关，零知识证明的计算过程非常依赖随机数作为输入，但如果初始的随机数被掌握，可能使得后续的计算变得可预测，产生被攻击的风险。



#### 3.6 ZK 发展路线 ZK-VM vs ZK-EVM

##### **ZK-VM：从零知识证明的角度出发**

第一种思路是从零知识证明技术出发，**专门开发适用于零知识证明的算法，从而构建一个 ZK-VM [1] （零知识虚拟机），而不是原生兼容 EVM 的 ZK-EVM [2] （零知识以太坊虚拟机）**，在此基础上尽可能实现 EVM 兼容。

StarkWare 和 zkSync 都采用了这种路线。StarkWare 的 Cairo 语言和 zkSync 的 Zinc 语言都是原生的零知识编程语言，甚至前者的账户地址系统与以太坊也存在很大的差异。

这种路线的优点是能够充分发挥零知识证明的潜力，实现最大化的扩展性。但缺点是开发者需要学习新的编程语言，并且现有项目需要将 Solidity 语言 [3] 的代码转换为 ZK-VM 的代码，这个过程中可能出现许多意想不到的问题，需要重新调试，重新审计。



##### **ZK-EVM：从 EVM 兼容性的角度出发**

反过来我们也可以从兼容 EVM 这个目的出发，**将 EVM 的交易在操作码 [4] 层面切割成更小的步骤，对每个步骤去找对应的零知识证明算法，力求实现完全的 EVM 兼容。** 这样做可以使开发者几乎无感地切换到二层网络，方便现有项目迁移，最大程度地保留目前的 EVM 生态成果。Scroll 和 Polygon Hermez 都采用了这种思路。

但是这种路线的缺点也显而易见，EVM 上的交易并非为零知识而设计，因此这种方法往往生成的证明体积较大，所需的时间也更长。



读到这里，我们已经了解了 Rollup 的当前进展。特别是零知识证明技术，令人感到十分神奇，使 Rollup 具备了非常大的潜力。但是仅仅通过 Rollup 实现扩容仍然存在上限，**未来我们还有其他提升的空间吗**？



> [1] VM（Virtual Machine）即虚拟机，一个由软件模拟硬件的可控代码执行环境。 ZK-VM（Zero Knowledge - Virtual Machine） 是适应于零知识证明的虚拟机。
>
> [2] ZK-EVM（Zero Knowledge - Ethereum Virtual Machine）是指利用了零知识证明技术的以太坊虚拟机，与原始的以太坊虚拟机有良好的兼容性。
>
> [3] Solidity 语言是以太坊原生的开发语言，大部分运行在以太坊网络上的智能合约均采用 Solidity 编写。
>
> [4] 计算机能直接读懂的语言是 0 和 1 ，操作码（Opcode）是非常底层的，与硬件（或是虚拟机中的虚拟硬件）直接交流的代码。操作码是指令集中每个指令的唯一标识符，在计算机执行指令时，用于识别具体指令的一个数字或符号。例如，在 x86 指令集中，加法指令（ADD）有一个特定的操作码，用于标识该指令。
>
> 此外还有一些相关概念：
>
> 1. 指令集（Instruction Set）： 指令集是一种用于编程的低级语言，它是计算机硬件能够理解和执行的一组指令。每种处理器都有自己的指令集，这些指令集定义了处理器可以执行的基本操作，如数据移动、算术和逻辑运算、条件分支等。指令集也被称为指令集架构（ISA，Instruction Set Architecture）。
> 1. 字节码（Bytecode）： 字节码是一种中间代码，介于源代码和机器代码之间。字节码通常由虚拟机（如 Java 虚拟机，JVM）执行，而不是直接由硬件执行。字节码的目的是提供一种平台无关的代码表示形式，这样不同平台上的虚拟机都可以执行相同的字节码。字节码通常比源代码更接近机器代码，但仍需要经过解释或编译为特定硬件的指令集。
>
> 指令集是计算机硬件能够执行的一组基本操作，每个操作都有一个唯一的操作码（Opcode）。字节码是一种平台无关的中间代码形式，它在执行时需要虚拟机将其转换为特定硬件的指令集。在这个过程中，字节码中的指令也会有相应的操作码。总之，操作码是指令的标识符，它在指令集和字节码中都有应用。



### 4 未来展望

#### 4.1 其它解决方案：Validium 和 Volition

纵览二层扩容方案的发展历程，其实都源自于**数据可用性**影响了安全性与实用性。

1. 侧链方案，数据对主链来说不可用，所以无法继承主链安全性。
1. Plasma 方案，状态根可以保障链下账本的不被篡改，但具体交易数据对一层网络来说也不可用，导致资金退出困难。
1. OP-Rollup 方案，让所有交易的详细数据都存在一层网络上，确保了全部交易数据的可用性，从而确保二层网络的安全。
1. ZK-Rollup 方案，提供关键交易数据以及能证明链下交易已经被正确执行的零知识证明，实现安全性的同时，还能一定程度保证隐私性。Rely on Math，Not Validator.

那么基于**零知识证明和数据可用性的新组合**，我们可以得到 Validium 和 Volition （由 StarkNet 提出）两种未来可行的方案。



##### Validium

ZK-Rollup 仍向主网上传了交易数据，那如果我们进一步牺牲一点点安全性，连交易数据也不上传到一层，仅上传状态根和证明交易已被正确执行的零知识证明，由二层网络自行解决交易数据的保存，就可以进一步降低交易成本，这就是 Validium。

它有点像零知识版的 Plasma，Plasma 需要用户参与监督交易是否被诚实执行，而采用了零知识证明之后，不诚实的交易无法生成证明，极大地提升了节点作恶的难度。并且因为交易数据对于一层网络来说完全不可用，Validium 将具有更高的隐私性。



##### Volition

Volition 是 Validium 方案的改进版本，允许用户可以自行选择其交易数据是否在一层网络可用，涉及大额资金的交易可以采用成本略高但安全性更好的交易上链模式。资金量较小的、更追求隐私的交易可以使用交易记录不上链的模式。



> **1. Validium：链下数据 + ZK 证明**
>
> **核心特点**
>
> - **数据存储**：交易数据存储在链外（由第三方委员会或去中心化网络维护，如 StarkEx 的 DAC）。
> - **安全性依赖**：依赖数据可用性委员会（DAC）的诚实性，若委员会作恶可能冻结资金（但无法盗取，因 ZK 证明保证状态正确）。
> - **优势**：
> 	- 极低的交易成本（无需支付以太坊主网的数据存储费用）。
> 	- 高吞吐量（适合高频交易场景，如交易所、游戏）。
> - **劣势**：
> 	- 牺牲部分去中心化（需信任 DAC）。
> 	- 用户无法独立验证数据（需委员会配合提供数据）。
>
> **典型应用**
>
> - **dYdX**（V3 版本）：采用 Validium 模式处理现货交易，降低手续费。
> - **Immutable X**：为 NFT 交易提供零 Gas 费体验。
>
> ------
>
> **2. Volition：用户自选数据存储模式**
>
>  **核心特点**
>
> - **混合架构**：允许用户为每笔交易选择数据存储方式：
> 	- **ZK-Rollup 模式**：数据上链（高安全性，高成本）。
> 	- **Validium 模式**：数据链下（低成本，依赖 DAC）。
> - **灵活性**：同一应用中，不同用户（甚至同一用户的不同交易）可自由选择模式。
> - **优势**：
> 	- 平衡安全性与成本（例如，大额交易选 Rollup，小额选 Validium）。
> 	- 无需迁移即可切换模式。
> - **劣势**：
> 	- 实现复杂度较高。
>
> **典型应用**
>
> - **StarkEx**（StarkWare 的引擎）：支持 Volition，供开发者灵活配置。
> - **Sorare**（梦幻足球 NFT 平台）：对普通用户用 Validium，对机构用户用 Rollup。



|   **维度**   |         **Validium**         |               **Volition**               |
| :----------: | :--------------------------: | :--------------------------------------: |
| **数据存储** |       强制链下（DAC）        | 用户可选链上（Rollup）或链下（Validium） |
|  **安全性**  |           依赖 DAC           |           用户自主控制安全等级           |
|   **成本**   |     极低（无链上数据费）     |       按需支付（Rollup 模式更贵）        |
| **适用场景** | 高频、低价值交易（如交易所） |   需灵活性的应用（如混合型 DeFi/NFT）    |
| **代表项目** |     dYdX V3, Immutable X     |      StarkEx 生态项目（如 Sorare）       |



#### 4.2 Deneb 更新与 Layer 2

以太坊 Deneb 更新（原 EIP-4844 ）是以太坊扩容路线 DankSharding 的前置步骤，旨在保证以太坊信标链安全性的前提下，为 Layer 2 扩容提供更大的储存资源。



Deneb 更新添加了一种新的交易：Blob 交易（大型二进制对象 Binary Large Object）。在主链上只留存指针，指针指向一个 Blob 块，上面可以储存约 128KB 的二进制数据。

以太坊矿工只负责在一段时间内（如一个月）保存 Blob 上的数据，通过随机抽样的方式确保 Blob 上二进制数据的真实性，但不验证存在 Blob 上的交易。

Blob 交易看起来对常规交易的扩容没有帮助，但这对于 Layer 2 打包的交易数据来说简直是完美契合。Layer 2 原先定期上传给 Layer 1 上的打包交易数据本来就不会执行，只是起到保障数据可用性的作用。

而 Blob 本身就相当于一个公示板，消息在公示板上的存续时间超过了 OP-Rollup 的挑战期，实践上完全够用，存储成本却降低了许多，这将促使 Layer 2 的交易成本进一步降低。

Blob 增加的唯一缺憾是超过保存期之后，Layer 2 如果想保存自己的全部历史交易数据，需要用另外的方案自行解决这些数据的可用性问题。

 

总体来说，Deneb 更新之后，Layer 2 将可以在保证安全性的同时进一步降低交易成本，变得更具实用价值。

探索到这里，**我们增加了这么多性能，在应用层能有什么提升吗？** 还是单纯只是量的堆积？



#### 4.3 账户抽象与大规模应用

钱包毫无疑问是 Web3 最重要的流量入口，是用户进入 Web3 世界最重要的工具，大部分用户主要接触到的钱包都是 EOA 钱包（外部拥有账户），即通过私钥和助记词掌握整个钱包的权限（如 MetaMask、Coinbase Wallet、Trust Wallet 等），这种 EOA 钱包有如下问题：

1. 高学习成本：用户需要了解复杂的非对称加密知识，理解任何人拥有私钥就能拥有账户，失去私钥就是失去资金的控制权。
1. 单点失效问题：私钥泄露丢失，或忘记密码时，既不能用手机或邮箱，也不能柜面处理用身份证件恢复，资产将永久丢失。
1. 风险控制难度较高：存在很多恶意攻击手段，试图盗取私钥；或在不盗取私钥的前提下，用恶意授权、恶意签名等方式盗取用户资产。新用户需要漫长的学习，具备谨慎的使用习惯才能保护资产安全。
1. 不支持智能合约：无法实现复杂多样的高级功能，如多签、批量发送代币等等。



**账户抽象**（Account Abstraction）本质上是个智能合约钱包。是指将某些功能和具体实现细节抽象出来，用一系列的智能合约模拟出一个“账户”的效果，脱离了 EOA 账户用私钥控制地址的底层原理，允许其它更人性化的确认账户所有权的方式，并让整个账户的功能更加灵活。它解决了现有 EOA 账户的问题：

1. 更符合现有的账户使用习惯：可以像传统 Web2 服务一样登陆，使用邮箱、手机短信、两步验证等验证方法。
1. 更多安全保障机制：出现安全风险时可以紧急暂停账户功能，并采用社交恢复等手段重新掌握账户控制权。
1. 可以接入第三方安全模块：接入专业的风控模块，过滤风险操作，从底层降低被攻击的可能。
1. 支持智能合约的更多功能：让用户在不具备代码能力的情况下使用多签、批量发送多种代币、批量授权额度等等操作。



甚至还增加了许多新的可能：

1. 代理支付 Gas 费：允许第三方支付 Gas 费，可以由钱包运营商补贴 Gas 费来吸引用户，钱包作为入口展现商业价值，用户享受更便宜的服务。
1. 条件交易：在满足一定条件时自动执行某些交易。
1. 跨链操作：可以和跨链桥智能合约实现原生的交互，更灵活地实现资产跨链和其他跨链交互。
1. 更多 DeFi 场景：账户抽象为 DeFi 提供了更多可能，如批量交易、自动借贷、流动性挖矿等。

账户抽象极大地拓展了以太坊的可能性，但账户抽象的问题在于一切交易都基于智能合约完成，Gas 成本较高，这让它在以太坊主网上显得过于昂贵。

Layer 2 作为一个执行层，天然适配账户抽象，用户不会感知到私钥甚至不会感知到 Gas 费的存在。智能合约钱包本身就是程序，能引入风控等第三方服务，让转账和交互变得安全，有更多的丰富业务场景可以实现。可以说将来区块链技术的大规模应用技术离不开账户抽象，而账户抽象需要成本更低的 Layer 2 才能成立。

# 2025-08-06

| 今日学习内容           |
| ---------------------- |
| MyFirstLayer2 部分学习 |
| 区块链岗位全景图       |



## MyFirstLayer2

### 1 公链瓶颈

#### 1.1改进尝试

为了确保参与的低门槛，比特币将整个网络的区块生成时间控制在 10 分钟左右，从而使平均每秒交易数 （TPS） 为个位数。以太坊的区块生成时间约为 12 秒，平均 TPS 仅为几十。与传统 Web2 的经济活动相比，这还不够

提高区块链性能的两个尝试：

- <u>增加单个区块的大小以容纳更多交易</u>

	这种方法导致区块链账本迅速膨胀，对参与验证机器的性能要求越来越高，提高了进入门槛，并逐渐降低了整个网络的去中心化和安全性。从比特币分叉出来的比特币现金（BCH）将区块大小从 1MB 增加到 32MB，而比特币中本聪的愿景（BSV）则更积极地取消了区块大小限制，允许将无限量的信息合并到区块中。

- <u>减少区块生成时间，目标是在一定时间内生成更多区块，以处理更多交易</u>

	这种方式对节点的网络条件提出了更高的要求，增加了进入门槛。它还影响了整个网络数据同步的稳定性，因为物理上相距较远的节点集群容易对最新区块产生分歧意见，从而导致分叉。分叉链需要竞争产生一条新的最长链，丢弃一个分支并导致在一定时期内重写许多交易，称为“区块重组”。Polygon 在 2023 年经历了 157 次区块重组事件

此外，一些公链试图以更激进的方式提高性能：

- *<u>使用更少的超级节点进行通信</u>*

	超级节点具有更高的性能和更好、更稳定的网络带宽，使它们之间的通信速度超快。然而，这显然降低了去中心化。例如，Fantom 有 51 个共识节点，而币安智能链（BSC）、EOS 和 TRON 只有 21 个超级节点。

- <u>使用特殊的共识机制来增强性能</u>

	共识机制决定了网络中的节点如何就区块生成达成共识。一些特殊的机制可能会提高区块生成速度，但共识机制越复杂，对机器性能的要求就越高，单点故障就越容易造成系统错误。例如，Solana 依靠从整个节点网络中随机选择的单个领导者节点进行协调，实现了理论上较高的 TPS 上限。但对节点性能要求极高，曾多次发生全网宕机安全事件。

高性能公链的探索成果普遍实现了 TPS 提升至 100-1000，但共识节点数量减少到 10s 至 1000 以上的区间。与以太坊在全球拥有近 10000 个分布式共识节点 [3] 相比，高性能公链的性能提高了一两个数量级，而去中心化程度却下降了一两个数量级。那么，区块链在尝试改进 Layer 1 时面临哪些挑战 [4] 呢？



#### 1.2 区块链三难困境

区块链三难困境代表了设计区块链系统时三个主要目标之间的冲突：**去中心化**、**安全性**和**可扩展性**

1. 去中心化：这需要确保区块链系统内的所有节点拥有平等的权力，而没有单一的中心化机构控制网络。去中心化是区块链的一个基本方面，是系统安全和抵御攻击的基础。
1. 安全性：安全性涉及确保区块链系统内交易的真实性、完整性、不变性和抵抗攻击性。它是区块链系统可靠性和可信度的重要保证。
1. 可扩展性：可扩展性或性能是指区块链系统支持大量交易、节点和用户的能力。这是满足现实世界需求的基本要求。

这三个目标往往需要权衡。例如，追求更高的去中心化程度需要所有节点存储完整的区块链数据，但这可能会阻碍可扩展性。相反，优先考虑可扩展性可能涉及牺牲一定程度的去中心化。例如，采用分片技术来增加容量可能会导致节点之间的数据同步面临挑战，并增加安全泄露的风险。

**高安全性和高可扩展性**

追求高安全性和可扩展性（性能）通常涉及依赖有限数量的超级节点进行通信。这些超级节点拥有卓越的性能和最佳的网络条件，使它们之间能够实现超快的通信。然而，由于进入门槛高，这种方法损害了去中心化水平。

代表性区块链：BSC、EOS 和 TRON 使用仅由 21 个高性能节点维护的网络运行。

**高可扩展性和高去中心化**

追求高可扩展性（性能）和去中心化往往涉及实施众多验证节点来加强去中心化。为了提高性能，采用了加快区块生成速度或采用独特的共识机制等策略。然而，加速区块生成可能会无意中触发广泛的区块重组。同样，更复杂的共识机制可能会导致网络范围的中断和其他安全漏洞，从而危及安全性。

代表区块链：2023 年，Polygon 经历了 157 个区块的重大重组。在运营的头两年内，Solana 遇到了 8 次全网中断。

**高去中心化和高安全性**

追求高度去中心化和安全性通常涉及使用更多的节点和更公平的区块生成方法，这些方法被认为是值得信赖的。然而，在验证过程中容纳性能较低的节点并管理全球网络延迟可以减少每秒可处理的交易数量，从而影响性能。

代表性区块链：BTC 和 ETH 优先考虑卓越的安全性和去中心化。然而，这是以交易处理速度较慢为代价的，BTC 每秒处理大约 7 笔交易，而 ETH 每秒处理 10 到 20 笔交易。



#### 1.3 Layer 2

事实上，有一种方法可以克服区块链三难困境。在工程实践中，我们可以通过引入额外的层来解决这三个目标之间的权衡。添加层可以实现业务解耦，减轻原层的负担

我们引入第二层网络（Layer 2）来分担第一层网络（Layer 1）的负载，实现可扩展性。

> Layer 2是指构建在主层之上的辅助网络。它是一种采用各种技术手段来促进底层公链可扩展性的解决方案。



### 2 Layer 2历史

#### 2.1 状态通道（State channel）

> 以爱丽丝为例，她是一家咖啡店的常客。如果她每购买一杯 5 美元的咖啡就需要支付 0.5 美元的交易费，那么很快就会变得昂贵。相反，如果爱丽丝和咖啡店同意使用已签署的欠条怎么办？爱丽丝每次购买咖啡时，都会递给商店一张签名的欠条。一段时间后，咖啡店可以一次性将累积的欠条兑换付款，从而大幅降低交易成本。这个想法标志着Layer 2的起源，称为状态通道。

**状态通道** 是一种区块链扩容技术，允许用户在链下进行高频、低成本的交互，仅在开启和关闭通道时与区块链交互，从而实现近乎即时、零摩擦的交易。状态通道利用多重签名技术 [1]，允许两方将一笔资金锁定在智能合约中，从而创建一个内部通道。在这个渠道内，他们可以快速、廉价地进行大量小额交易

- [1] 多重签名技术涉及要求多个授权者共同批准交易，从而增强安全性和可靠性。

例如，公司的资金可能需要至少三名授权人员中的两名 （2/3） 的签名才能访问。在状态通道中，交易同时需要双方的签名（2/2）才能有效。多重签名还允许存在额外的 n/m 授权条件。

> **1. 核心原理**
>
> **(1) 基本流程**
>
> 1. **开启通道**：
> 	- 双方将资金锁定在链上的智能合约中（如存入 10 ETH）。
> 	- 生成初始状态（如 Alice: 6 ETH，Bob: 4 ETH），并签名确认。
> 1. **链下交易**：
> 	- 双方通过签名消息更新状态（如 Alice 转 1 ETH 给 Bob → Alice:5, Bob:5）。
> 	- **无需矿工/验证者**，交易即时生效。
> 1. **关闭通道**：
> 	- 将最终状态提交到链上，合约根据最新状态分配资金。
> 	- 若有争议（如一方提交过期状态），可挑战并惩罚作弊者。
>
> **(2) 技术关键点**
>
> - **多签名验证**：每次状态更新需双方签名。
> - **时间锁（Timelock）**：防止旧状态被恶意提交。
> - **欺诈证明（Fraud Proof）**：允许诚实方在争议期举证。
>
> **2. 为什么需要状态通道？**
>
> |     **问题**     |   **状态通道解决方案**   |
> | :--------------: | :----------------------: |
> | 链上交易慢且昂贵 | 链下交易零成本，即时确认 |
> | 区块链吞吐量有限 |    支持无限次链下交互    |
> |     隐私性差     | 交易细节仅在参与者间传递 |
>
> ------
>
> **3. 典型应用场景**
>
>  **(1) 高频微支付**
>
> - **案例**：
> 	- 按秒计费的视频流服务（如每小时支付 0.001 ETH）。
> 	- 游戏内道具实时交易。
>
>  **(2) 链下投票与治理**
>
> - **案例**：
> 	- DAO 成员在通道内频繁投票，最终结果上链。
>
> **(3) 隐私保护交易**
>
> - **案例**：
> 	- 双方链下协商价格，仅公开最终交易。
>
> **4.优缺点**
>
>  **✅ 优点**
>
> - **零延迟**：交易即时完成。
> - **零 Gas 费**：链下交互无需付费。
> - **隐私性**：交易细节不上链。
>
> **❌ 缺点**
>
> - **通道管理复杂**：需预先锁定资金。
> - **适用性有限**：仅适合固定参与者间的交互。
> - **流动性要求**：长期占用资金。



然而，这种方法会产生两个新问题：

1. Alice 与咖啡店达成的积累借条的协议仅适用于简单的转账交易。去中心化金融旨在促进更复杂的交易。那么， **我们如何才能实现复杂的交易呢？** 这致使了**侧链**解决方案的出现。
1. 虽然 Alice 可以将资金转移到咖啡店，甚至通过渠道将资金发送到超市，但**她如何向不参与闪电网络的人发送资金呢？** 这一挑战催生了**等离子体**解决方案。



#### 2.2 侧链（Sidechain）

为了克服状态通道在**处理复杂交易**方面的局限性，侧链解决方案应运而生。

**侧链** 是一种与主区块链（如以太坊、比特币）**并行**运行的独立区块链，通过双向锚定（Two-way Peg）机制与主链互联，实现资产和数据跨链转移。其核心目标是 **扩展主链功能**，同时保持一定程度的去中心化和安全性。



**侧链核心特性**

|   **特性**   |                        **说明**                         |
| :----------: | :-----------------------------------------------------: |
|  **独立性**  | 拥有自己的共识机制（如 PoA、PoS）、区块参数和智能合约。 |
| **双向锚定** |      资产可从主链锁定后映射到侧链，也能反向返回。       |
| **互操作性** |           通过桥接协议（Bridge）与主链通信。            |
|  **定制化**  |   可针对特定需求优化（如高TPS、低Gas费、隐私增强）。    |

侧链经过定制以提高性能并减轻主链上的交易负载。

- 侧链采用权益证明（**PoS**）共识机制，显著提高了区块创建速度，从而实现了可扩展性。例如，Polygon 侧链已将区块时间减少到 2 秒。
- 采用权威证明（**PoA**）共识机制，侧链可以在更少的授权超级节点进行通信的情况下实现超高性能。一个例子是 Ronin 侧链，它支持游戏资产交易。鉴于游戏中 NFT 资产更加中心化的性质，这种方法是可以接受的。



**侧链的工作原理**

**(1) 资产跨链流程（以以太坊 ↔ Polygon 为例）**

1. **存款（主链 → 侧链）**
	- 用户将 ETH 存入主链的桥合约，合约锁定资产并生成证明。
	- 侧链验证证明后，在侧链上 mint 等量的封装资产（如 WETH）。
1. **提款（侧链 → 主链）**
	- 用户销毁侧链的 WETH，提交销毁证明到主链桥合约。
	- 主链合约验证后解锁原始 ETH。

**(2) 共识机制差异**

- **主链**：通常采用高安全共识（如以太坊的 PoS）。
- **侧链**：可能使用更高效的共识（如 Polygon PoS 链的 Bor 共识）。



**为什么需要侧链？**

|      **主链瓶颈**       |               **侧链解决方案**               |
| :---------------------: | :------------------------------------------: |
| 低TPS（如以太坊15 TPS） |  侧链可达数千 TPS（如 Polygon 7,000 TPS）。  |
|         高Gas费         | 侧链交易成本极低（如 BSC 的 $0.01 交易费）。 |
|        功能限制         |  侧链可定制模块（如隐私交易、游戏专用链）。  |



 **典型侧链项目**

|      **侧链**      | **锚定主链** |         **特点**         |    **用例**    |
| :----------------: | :----------: | :----------------------: | :------------: |
|  **Polygon PoS**   |    以太坊    |      高TPS，EVM兼容      |   DeFi、NFT    |
|  **Gnosis Chain**  |    以太坊    | 注重去中心化，xDai 合并  |   支付、DAO    |
| **Liquid Network** |    比特币    |  联邦桥接，支持机密交易  | 比特币快速结算 |
|     **Ronin**      |    以太坊    | Axie Infinity 游戏专用链 |     GameFi     |



**侧链的安全风险**

**(1) 桥接攻击**

- **案例**：2022 年 Ronin 桥被盗 6.25 亿美元（私钥泄露）。
- **防御**：使用多重签名、零知识证明桥（如 zkBridge）。

**(2) 共识中心化**

- 部分侧链（如 BSC）由少数节点控制，可能被操纵。

**(3) 资产锚定失效**

- 若桥合约漏洞导致双向锚定断裂，侧链资产可能脱钩。



侧链通过 **牺牲部分主链安全性** 换取高性能和低成本，是区块链生态的重要扩容手段。用户在使用时需权衡 **效率、成本与风险**，优先选择经过时间验证的侧链和桥接协议。



#### 2.3 Plasma

状态通道和侧链解决方案的实际实施暴露了某些缺陷，导致了 Plasma 解决方案的提出，并受到了广泛关注。它解决了以前方法中发现的两个问题：

- 无法**向非参与者发送资金** ：未连接到 Plasma 链的账户可以接收资金并独立提取到 Layer 1。
- **<u>无法继承 Layer 1 安全性</u>** ：Plasma 定期向主链提交信息以继承 Layer 1 安全性。

**Plasma** 是以太坊创始人 **Vitalik Buterin** 和 **Joseph Poon** 在 2017 年提出的一种 **区块链扩容方案**，旨在通过构建多层链下结构（“子链”），将大部分交易从<u>主链（如以太坊）卸载到子链上处理</u>，从而显著提升吞吐量并降低交易成本。尽管后期因技术复杂性被 Rollup 取代，但 Plasma 的设计思想仍对 Layer2 发展影响深远。



**Plasma 的核心思想**

 **(1) 分层结构**

- **主链（Root Chain）**：以太坊等底层区块链，负责最终结算和争议仲裁。
- **子链（Plasma Chain）**：独立的链下区块链，处理高频交易，定期向主链提交状态承诺（Merkle Root）。

**(2) 关键机制**

- **状态承诺**：子链将交易批量打包后，生成 Merkle Root 并提交到主链。
- **欺诈证明（Fraud Proof）**：若子链作恶（如篡改交易），用户可提交证明至主链，触发惩罚和状态回滚。
- **资金退出（Exit）**：用户需通过主链的“退出游戏”机制安全取回资金。



**Plasma 的工作原理**

**(1) 存款（主链 → Plasma 链）**

1. 用户将资产（如 ETH）锁定在主链的 Plasma 智能合约中。
1. Plasma 链生成对应的资产凭证（如 1:1 映射的代币）。

**(2) 链下交易（Plasma 链内）**

- 用户在 Plasma 链上自由交易（如转账、支付），无需主链确认。
- 子链区块生产者（Operator）定期将交易打包，并提交 Merkle Root 到主链。

**(3) 提款（Plasma 链 → 主链）**

1. 用户发起提款请求，启动 **7天挑战期**（类似 Optimistic Rollup）。
1. 若无争议，主链释放锁定的资产；若有欺诈，提交证明取消提款。



**Plasma 的优缺点**

**✅ 优点**

- **高吞吐量**：交易在子链处理，主链仅存储压缩数据。
- **低成本**：Gas 费由子链承担，主链仅需极低开销。
- **安全性继承**：依赖主链的**欺诈证明机制**确保资金安全。

 **❌ 缺点**

- **退出延迟**：提款需等待挑战期（7天），流动性受限。
- **数据可用性问题**：**<u>若子链运营商隐藏数据，用户无法构造欺诈证明。</u>**
- **通用性差**：难以支持复杂智能合约（仅适合支付等简单逻辑）。



**为什么 Plasma 逐渐被淘汰？**

1. **数据可用性问题**：用户无法获取子链完整数据时，无法挑战无效交易。
1. **用户体验差**：提款延迟长，且需主动监控欺诈。
1. **Rollup 的崛起**：
	- **ZK Rollup** 通过零知识证明解决数据问题。
	- **Optimistic Rollup** 保留欺诈证明但强制数据上链，平衡安全与成本。



#### 2.4 Rollup

虽然 Plasma 可能没有获得广泛接受，但其原理的某些元素在随后的第 2 层解决方案中得到了保留和进一步发展。

鉴于 Plasma 的主要挑战集中在**数据可用性**上，特别是审计师在访问交易数据进行验证时面临的障碍，如果我们不仅上传根证明，而且将所有重要的交易数据合并到Layer 1会怎样？这能否为问题提供可行的解决方案？

这种思路带来了目前最实用的 Layer 2 扩容解决方案：Rollup。术语“Rollup”是指将一定时期内的交易进行合并、打包并定期上传到主网的捆绑过程。目前主流的 Rollup 方案大致可以分为两大类：**Optimistic Rollup** 和**零知识 Rollup**。



**Rollup 的核心思想**

**(1) 链下执行 + 链上验证**

- **链下**：交易在 Rollup 链（Layer2）上执行。
- **链上**：交易数据（或有效性证明）提交到主链（Layer1），确保安全性。

**(2) 数据压缩**

- Rollup 将多笔交易压缩为 **单个批次**，减少链上存储开销。
- 例如：1000 笔交易 → 1 个 Rollup 区块 → 1 笔主链交易。



**Rollup 的两种类型**

**(1) Optimistic Rollup（乐观汇总）**

- **假设交易合法**，默认不验证，依赖 **欺诈证明（Fraud Proof）** 争议机制。
- **特点**：
	- 兼容 EVM（如 Arbitrum、Optimism）。
	- 提款需等待 **7天挑战期**。
	- 成本低，适合通用智能合约。

**工作流程**：

1. 交易在 Layer2 执行。
1. 排序器（Sequencer）将交易数据（Calldata）提交到主链。
1. 若有欺诈，验证者在挑战期内提交证明，回滚错误状态。

**(2) ZK Rollup（零知识证明汇总）**

- 每批交易生成 **零知识证明（ZK-SNARK/STARK）**，主链即时验证。
- **特点**：
	- 无需挑战期，提款即时到账。
	- 证明生成计算量大，早期难兼容 EVM（现 zkEVM 已突破）。
	- 隐私性更强（可隐藏交易细节）。

**工作流程**：

1. 交易在 Layer2 执行。
1. 生成有效性证明（Proof）并提交到主链。
1. 主链验证证明后，更新状态。



**Rollup 的优缺点**

**✅ 优点**

- **高扩展性**：吞吐量提升百倍。
- **安全性**：依赖主链验证，抗审查。
- **低成本**：Gas 费仅为链上的 1/10~1/100。

**❌ 缺点**

- **Optimistic 的延迟**：提款需等待 7 天（可通过流动性提供商缓解）。
- **ZK 的硬件需求**：证明生成需要高性能服务器。
- **中心化风险**：排序器可能被垄断（逐步去中心化中）。



> ### **零知识证明（Zero-Knowledge Proof, ZKP）详解**
>
> **零知识证明** 是一种密码学技术，允许一方（证明者）向另一方（验证者）**证明某个陈述的真实性**，而无需透露任何额外信息。其核心思想是：**“我知道一个秘密，但我不会告诉你秘密是什么”**。
>
> 在区块链领域，ZKP 是隐私保护（如 Zcash）和扩容（如 ZK Rollup）的核心技术。
>
> #### **1. 零知识证明的三大核心特性**
>
> 1. **完备性（Completeness）**：
> 	- 如果陈述为真，诚实验证者一定会被说服。
> 1. **可靠性（Soundness）**：
> 	- 如果陈述为假，作弊的证明者无法欺骗验证者。
> 1. **零知识性（Zero-Knowledge）**：
> 	- 验证者除了“陈述为真”外，无法获取任何其他信息。
>
> #### **2. 经典类比：洞穴寓言**
>
> 假设有一个环形洞穴，中间有一道需要密码才能打开的门。
>
> - **证明者**知道密码，想向**验证者**证明这一点，但不想泄露密码。
> - **过程**：
> 	1. 验证者站在洞口，随机要求证明者从左侧（A）或右侧（B）进入。
> 	1. 证明者无论从哪边进入，都能用密码开门并从另一侧出来。
> 	1. 重复多次后，验证者确信证明者确实知道密码，但始终不知道密码是什么。
>
> #### 3. 零知识证明的两种主要类型
>
> **(1) 交互式零知识证明（Interactive ZKP）**
>
> - 需要多轮通信（如洞穴寓言中的多次进出）。
> - **缺点**：效率低，不适合区块链。
>
> **(2) 非交互式零知识证明（Non-Interactive ZKP, NIZK）**
>
> - 证明者生成单次证明，验证者可随时检查。
> - **区块链常用**：如 ZK-SNARKs、ZK-STARKs。
>
> #### **4. 区块链中的 ZKP 技术**
>
>  **(1) ZK-SNARKs（简洁非交互式知识论证）**
>
> - **特点**：
> 	- 证明体积小（约 200 字节），验证速度快。
> 	- 需要“可信设置”（Trusted Setup），存在潜在风险。
> - **应用**：
> 	- **Zcash**（隐私转账）。
> 	- **zkSync**（ZK Rollup）。
>
>  **(2) ZK-STARKs**
>
> - **特点**：
> 	- 无需可信设置，抗量子计算。
> 	- 证明体积较大（约 100 KB），但验证速度仍快。
> - **应用**：
> 	- **StarkNet**（以太坊 Layer2）。
>
> **(3) Bulletproofs**
>
> - **特点**：
> 	- 无需可信设置，适合范围证明（如 Confidential Transactions）。
> - **应用**：
> 	- **Monero**（隐私币）。
>
> #### **5. 零知识证明的区块链应用**
>
> **(1) 隐私保护**
>
> - **匿名交易**：Zcash 使用 ZK-SNARKs 隐藏发送方、接收方和金额。
> - **身份验证**：证明年龄 >18 岁，而无需透露出生日期。
>
>  **(2) 扩容（ZK Rollup）**
>
> - <u>将数千笔交易打包，生成 ZKP 证明提交到主链，验证者只需检查证明即可确认有效性。</u>
> - **代表项目**：zkSync、StarkNet、Scroll。
>
> **(3) 去中心化存储验证**
>
> - 证明文件已正确存储，而无需下载全部数据（如 Filecoin）。
>
> #### **6. 零知识证明的优缺点**
>
> **✅ 优点**
>
> - **隐私性**：隐藏敏感数据（如交易详情）。
> - **扩展性**：减少链上计算负担（如 ZK Rollup）。
> - **安全性**：数学上无法伪造证明。
>
> **❌ 挑战**
>
> - **计算密集型**：生成证明需要高性能硬件。
> - **可信设置（ZK-SNARKs）**：初始参数若泄露，可能伪造证明。
> - **开发门槛高**：需要密码学专业知识。



#### 2.5 Layer 2 对比

**核心特性对比**

|   **维度**   |     **State Channel**     |    **Sidechain**     |    **Plasma**     |        **Rollup**        |
| :----------: | :-----------------------: | :------------------: | :---------------: | :----------------------: |
|  **安全性**  |       依赖最终结算        |     依赖侧链共识     | 依赖主链欺诈证明  |      继承主链安全性      |
| **交易速度** |       即时（链下）        | 较快（依赖侧链性能） | 较快（链下执行）  |     较快（链下执行）     |
|   **成本**   | 链下免费，仅开/关通道付费 |   低（侧链Gas费）    |       极低        |     极低（数据压缩）     |
| **去中心化** |  需预存资金，参与者固定   |   可变（PoA/PoS）    |    依赖运营商     |       逐步去中心化       |
| **数据存储** |      仅最终状态上链       |     独立链上存储     | 仅提交Merkle Root | 交易数据全上链（Rollup） |
| **适用场景** |  高频小额支付（如游戏）   | 独立生态（如GameFi） | 简单支付/资产转移 |       通用智能合约       |



**工作原理对比**

**(1) State Channel（状态通道）**

- **流程**：
	1. 双方锁定资金在主链。
	1. 链下无限次交易（仅双方签名）。
	1. 最终结算状态上链。
- **例子**：比特币闪电网络、以太坊的Raiden Network。

**(2) Sidechain（侧链）**

- **流程**：
	1. 资产通过桥锁定在主链，映射到侧链。
	1. 侧链独立运行（自有共识机制）。
	1. 提款时反向桥接回主链。
- **例子**：Polygon PoS链、Ronin（Axie Infinity侧链）。

 **(3) Plasma**

- **流程**：
	1. 资产锁定在主链Plasma合约。
	1. 子链处理交易，定期提交Merkle Root到主链。
	1. 提款需挑战期（防欺诈）。
- **例子**：早期OMG Network（已转向Rollup）。

 **(4) Rollup**

- **流程**：
	1. 交易在链下执行并压缩。
	1. 数据批量提交到主链（Optimistic需欺诈证明，ZK需有效性证明）。
- **例子**：Optimism（OP）、Arbitrum、zkSync。



**安全性对比**

|     **方案**      |  **安全模型**  |            **主要风险**             |
| :---------------: | :------------: | :---------------------------------: |
| **State Channel** | 依赖参与者诚实 |      对手方离线时资金可能锁定       |
|   **Sidechain**   |  依赖侧链共识  |  桥接攻击（如Ronin被盗6.25亿美元）  |
|    **Plasma**     |  主链欺诈证明  | 数据不可用性问题（运营商隐藏数据）  |
|    **Rollup**     |  继承主链安全  | Optimistic的7天延迟，ZK的证明中心化 |



**优缺点总结**

|     **方案**      |          **优点**          |            **缺点**            |
| :---------------: | :------------------------: | :----------------------------: |
| **State Channel** | 零延迟，零Gas费，隐私性好  |   仅限固定参与者，需预存资金   |
|   **Sidechain**   |      高性能，灵活定制      |    安全性依赖侧链，桥接风险    |
|    **Plasma**     |      高吞吐量，低成本      |   退出延迟长，不支持复杂逻辑   |
|    **Rollup**     | 继承主链安全，支持智能合约 | Optimistic有延迟，ZK开发门槛高 |



**未来趋势**

- **Rollup 主导**：Optimistic 和 ZK Rollup 成为以太坊扩容主流。
- **State Channel 小众化**：仅用于特定场景（如微支付）。
- **Sidechain 专用化**：游戏、社交等垂直领域。
- **Plasma 淘汰**：被 Rollup 取代（因数据可用性问题）。



### 3 Rollup详情







## 区块链岗位全景图

### 一、技术岗

#### 1. 前端工程师

1. **主要职责：**

	- 设计和开发基于区块链技术的前端应用，支持去中心化平台的交互。
	- 通过 React、Vue 等框架实现高效的用户界面，支持钱包连接、交易签名、信息验证等功能。
	- 集成并优化智能合约的前端交互，确保链上数据与用户界面的无缝连接。
	- 与后端团队协作，基于 GraphQL 或 RESTful API 获取链上和链下数据。
	- 持续优化前端性能，提升用户体验，确保在不同设备和浏览器上的兼容性。
	- 关注 Web3 技术趋势，参与技术评审与分享，不断优化产品架构与代码质量。

1. **职位要求：**

	- 本科及以上学历，计算机科学或相关专业，具备扎实的计算机基础。
	- 精通 HTML、CSS、JavaScript，熟悉 React、Vue 等前端框架，能够独立构建复杂的 UI 界面。
	- 熟悉 Web3.js、Viem、Metamask 等 Web3 技术栈，能够与智能合约进行交互。（现在 Ethers.js / Web3.js 已经不怎么使用了，大家现在基本上都是用的 Viem）
	- 了解常用的区块链网络，如以太坊、Solana 等，具备 Dapp 开发经验者优先。
	- 熟悉 Git 版本管理工具，具备良好的代码编写规范，注重代码可维护性。
	- 良好的沟通能力和团队协作精神，能够在快速发展的环境中高效工作。
	- 具有良好的问题解决能力，能在面对复杂的技术难题时，提出创新的解决方案。
	- 有开源项目或 Web3 相关项目的经验优先。

	```bash
	# 常用技术栈
	- HTML5
	- CSS3
	- JavaScript (ES6+)
	- React / Vue
	- TypeScript
	- Next.js
	- Ethers.js / Web3.js / Viem
	```

#### 2. 后端工程师

1. **主要职责：**

	- 设计、开发和维护去中心化应用（Dapp）的后端服务，包括链上数据交互、智能合约集成和事务处理。
	- 与前端团队合作，确保前后端数据交互的高效性和稳定性，支持多种 Web3 钱包（如 Metamask）的集成。
	- 基于 Node.js、Python 等技术栈构建高性能的 RESTful 或 GraphQL API，以支持 Web3 平台的需求。
	- 与智能合约团队合作，确保智能合约与后端服务的无缝连接，优化链上数据的读取和写入效率。
	- 优化后端性能，确保系统的高可用性、高吞吐量和低延迟，满足高并发访问需求。
	- 定期进行系统架构和代码的评审，不断提升代码质量与技术标准。
	- 参与 Web3 技术的前沿研究，保持对新兴区块链技术的学习和应用，推动公司技术迭代。

1. **职位要求：**

	- 本科及以上学历，计算机科学或相关专业，具备扎实的计算机基础。
	- 精通 Node.js、Go、Python 等后端开发语言，具有构建高并发、分布式系统的经验。
	- 熟悉 Viem、Web3.js、Ethers.js 等 Web3 工具，能够与区块链进行交互并处理链上数据。
	- 具备 RESTful API 或 GraphQL 开发经验，能够设计高效的 API 服务，支持前端与区块链的交互。
	- 熟悉数据库技术，具备 MySQL、PostgreSQL 或 NoSQL 数据库的开发与优化经验。
	- 对智能合约有一定的了解，具备与智能合约交互、读取链上数据等相关经验。
	- 熟悉消息队列（如 RabbitMQ、Kafka）及事件驱动架构，能够处理异步事务。
	- 熟悉容器化技术（如 Docker、Kubernetes），具备 CI/CD 经验者优先。
	- 良好的代码编写规范与文档写作能力，具备良好的团队协作精神和沟通能力。
	- 有 Web3 项目开发经验或开源贡献者优先。

	```bash
	# 常用技术栈
	- Node.js / Go / Python
	- Viem / Web3.js / Ethers.js
	- RESTful API / GraphQL
	- MySQL / PostgreSQL
	- Docker / Kubernetes
	```

#### 3. 智能合约工程师

1. **主要职责：**

	- 设计、开发和部署智能合约，确保合约在区块链网络上的安全性、可靠性和高效性。
	- 使用 Solidity 编写智能合约，涵盖各类去中心化应用的需求，如 NFT、DeFi、DAO 等。
	- 与团队合作，定义智能合约的功能需求，并根据需求设计合适的智能合约架构。
	- 部署智能合约至区块链网络（如以太坊、Polygon、Arbitrum、Base 等），并确保合约的高效执行。
	- 编写智能合约的单元测试，进行代码审计与安全性测试，确保合约代码无漏洞，避免潜在的安全风险。
	- 优化智能合约性能，减少 Gas 费用。
	- 研究和应用最新的区块链技术和智能合约最佳实践，推动技术的持续进步。
	- 与前端和后端开发团队紧密协作，确保智能合约与其他系统组件的顺畅集成。
	- 为团队成员提供智能合约相关的技术支持和指导，推动团队的技术提升。

1. **职位要求：**

	- 本科及以上学历，计算机科学或相关专业，具备扎实的计算机基础。
	- 3 年以上智能合约开发经验，熟练使用 Solidity 或类似的智能合约开发语言。
	- 熟悉 Ethereum、Polygon、Arbitrum、Base 等主流区块链平台，能够在这些平台上部署和维护智能合约。
	- 了解智能合约开发的安全性问题，具备智能合约审计和漏洞修复经验，熟悉常见的攻击模式（如重入攻击、溢出、权限管理等）。
	- 熟悉区块链的基本原理，理解 Gas 费用、交易确认、区块链共识机制等概念。
	- 熟练使用 Foundry、Hardhat、Remix 等智能合约开发框架，具备项目开发、测试与部署经验。
	- 具备一定的 Viem、Web3.js、Ethers.js 等 Web3 工具使用经验，能够与前端或其他系统进行无缝集成。
	- 熟悉 IPFS、NFT、Token 标准（ERC-20、ERC-721、ERC-1155 等）及去中心化身份（DID）等 Web3 相关技术。
	- 具有良好的代码编写规范，注重代码的可读性和可维护性。
	- 良好的沟通能力和团队协作精神，能够在快速发展的环境中有效工作。

	```bash
	# 常用技术栈
	- Solidity
	- Remix
	- Foundry / Hardhat
	- Phalcon / Tenderly
	- Yul
	```

### 二、非技术岗

#### 1. 产品与运营

1. 职位描述：
	- 在 Web3 产品生命周期中负责协调产品发布、用户反馈收集和持续改进流程，以提升用户体验和产品迭代效率。
	- 执行以用户获取、留存和参与度提升为目标的增长战略，并监控实施效果。
	- 与产品、技术、市场及合规团队紧密合作，确保产品上市（go-to-market）策略与各部门需求保持一致。
	- 持续分析运营数据，跟踪关键绩效指标（KPIs），并根据数据提出优化建议。
1. 职位要求：
	- 熟悉产品上线（Go-to-market）全流程，擅长跨部门资源协调与项目推进。
	- 具备扎实的数据分析能力，能熟练使用 SQL、Excel 或其他数据工具进行数据统计和洞察提炼。

#### 2. 社区管理

1. 职位描述

	- 构建并管理 Telegram、Twitter（X）、Discord 等社交平台的社区，实现持续的用户互动与增长；
	- 组织线上 AMA（问答）、活动、竞赛等形式多样的社区互动，以提升用户活跃度和品牌粘性；
	- 跟踪社区健康度指标和情感分析，定期向管理层汇报洞察与优化建议；
	- 与营销团队协作，制定并执行内容日历，发布社区公告和运营手册。

1. 职位要求

	- Web3、DAO 或 NFT 社区管理经验，深刻理解去中心化应用生态；
	- 出色的文案撰写与沟通能力，能够有效引导社区讨论并快速响应用户反馈；
	- 熟练使用社区数据分析工具，能够监测并解读用户行为与舆情动态；
	- 具备活动策划与执行能力，能够独立组织线上及线下社区活动。

	```bash
	# 常用平台
	- Telegram
	- Twitter (X)
	- Discord
	```

#### 3. 研究分析

1. 职位描述

	- 收集、整理并分析 Web3 行业市场与用户数据，编写可行性研究报告，为产品与运营提供决策支持；
	- 跟踪区块链协议技术演进及生态动态，撰写深度研究报告或白皮书；
	- 进行竞争对手分析，评估市场趋势与用户行为模式，为战略规划提供数据驱动的建议；
	- 支持项目的加密经济模型设计与博弈论分析，以保证项目的经济激励合理性。

1. 职位要求

	- 熟练使用 Excel、SPSS 或 Python 等数据分析工具，具备定量和定性研究方法经验；
	- 深入了解区块链生态、DeFi 协议及加密经济学原理；
	- 优秀的报告撰写与演示能力，能够清晰传达研究结论与建议；
	- 精通链上数据分析工具（Glassnode、Token Terminal）。

	```bash
	# 常用工具
	- Excel
	- SPSS
	- Python
	- Glassnode
	- Token Terminal
	```

# 2025-08-05

# 

| 今日学习内容                 |
| ---------------------------- |
| 以太坊概览                   |
| unphishable钓鱼攻防挑战-初级 |



## 以太坊概览

### 以太坊介绍

以太坊（Ethereum）被称为“区块链 2.0”，它不仅是一种加密货币（以太币 ETH），更是一台支持智能合约的“全球共享计算机”。通过代码自动执行规则，开发者可以在区块链上构建去中心化金融（DeFi）、数字艺术品（NFT）和去中心化自治组织（DAO）等创新应用，无需依赖银行或中心化平台。

以太坊的核心创新在于 **智能合约**（Smart Contracts） 。<u>智能合约是存储在区块链上的可执行代码，能够在满足预设条件时自动执行操作，无需人工干预</u>。这一特性使得以太坊不仅是数字货币的载体，更是构建去中心化应用（Dapps）、去中心化金融（DeFi）、非同质化代币（NFT）等生态系统的基础设施。



### Ethereum 与 Bitcoin 的差异

|      维度      | 比特币（Bitcoin）                                            | 以太坊（Ethereum）                                          |
| :------------: | :----------------------------------------------------------- | :---------------------------------------------------------- |
| **目标与定位** | 去中心化的**数字货币**，强调安全、稳定和稀缺性（总量 2100 万枚） | 去中心化平台，支持**智能合约**和 Dapps，定位为“区块链 2.0”  |
|  **编程能力**  | 脚本语言有限，仅支持简单的交易验证逻辑                       | 图灵完备的编程语言（如 Solidity），可开发复杂智能合约       |
|  **共识机制**  | 工作量证明（PoW），矿工通过算力竞争记账权                    | 从 PoW 转向权益证明（PoS），通过 The Merge 实现能源效率优化 |
|  **交易速度**  | 每 10 分钟生成一个区块，交易确认较慢                         | 区块时间约 12 秒，交易确认更快，适合高频应用                |
|  **经济模型**  | 总量固定，强调抗通胀属性                                     | 供应灵活，通过 EIP-1559 等机制可能呈现通缩趋势              |



### 以太坊的定位与演进

#### 以太坊1.0（PoW阶段）

这个阶段就是挖矿，和比特币的机制相同，同样的消耗电力和处理交易速度慢、费用高



#### 以太坊2.0与The Merge：从双链并行到完美合并

> **The Merge 完整故事**：
>
> 1. **2020 年 12 月：信标链启动**
>
> 	以太坊团队首先创建了一条全新的**信标链（Beacon Chain）**，专门运行 PoS 共识机制。此时：
>
> 	- 以太坊主网继续使用 PoW 挖矿
> 	- 信标链独立运行 PoS 验证
> 	- 两条链并行存在，互不干扰
>
> 1. **2022 年 9 月：历史性合并**
>
> 	2022 年 9 月 15 日，**The Merge** 发生：
>
> 	- 以太坊主网“关闭”了 PoW 挖矿引擎
> 	- 将共识机制“插接”到信标链的 PoS 系统
> 	- 从此，以太坊主网由信标链保护安全
>
> 1. **合并后的新架构**
>
> 	现在的以太坊实际上是两层结构：
>
> 	- **执行层**：处理交易、智能合约（原主网）
> 	- **共识层**：管理验证者、确定区块顺序（信标链）

**PoS机制详解：**

**验证者如何工作**：

- **准入门槛**：质押 32 ETH 成为验证者
- **工作方式**：系统随机选择验证者来提议和验证区块
- **奖励机制**：验证者获得新发行的 ETH + 交易费用（gas）
- **惩罚机制**：作恶者质押的 ETH 被销毁（Slashing）

**相比 PoW 的优势**：

- **能耗降低 99.95%**：无需大量电力和硬件
- **经济安全性**：攻击成本约需控制全网 67% 的质押 ETH（价值数百亿美元）
- **最终确定性**：区块确认更快、更可靠



#### 未来升级路线

暂时学不懂



### 以太坊生态概览：L1、L2、Sidechains 等

以太坊的生态系统由多层架构组成，包括 **L1（主网）、L2（二层扩展解决方案）、侧链（Sidechains）** 等，共同支持高吞吐量和低费用的交易处理。

1. Layer 1（L1）
	- **以太坊主网**：核心区块链，负责最终安全性与共识。
	- **EVM**：以太坊虚拟机，执行智能合约代码。
	- **账户系统**：外部账户（EOA）与合约账户（CA）共同构成网络基础。
1. Layer 2（L2）
	- Rollup：通过将交易批量处理后提交至 L1，降低 Gas 费。
		- **Optimistic Rollup**：假设交易合法，仅在争议时验证。
		- **ZK Rollup**：通过零知识证明验证交易，无需链上争议。
1. **侧链（Sidechains）**：独立运行的链，通过**桥接**与主网交互。
1. **以太坊生态分层架构**



> **1. Optimistic Rollup（乐观汇总）**
>
> **核心思想**
>
> “默认信任，争议时验证” —— 假设所有提交到链上的交易是合法的，仅在有人提出质疑时进行验证。
>
> **工作流程**
>
> 1. **交易打包**：
> 	- 用户将交易发送给排序器（Sequencer），排序器批量打包交易并生成状态根（State Root），提交到主链（如以太坊）。
> 	- 主链仅存储交易数据（Calldata），不立即验证。
> 1. **挑战期（Fraud Proof）**：
> 	- 提交后有一段挑战期（通常 **7天**），任何人可质疑交易有效性。
> 	- 如果发现无效交易，验证者提交欺诈证明（Fraud Proof），触发链上计算并回滚错误状态。
> 1. **最终确认**：
> 	- 若挑战期内无争议，交易最终确认。
>
>  **优点**
>
> - **兼容性强**：支持任意智能合约（EVM 兼容）。
> - **Gas 成本低**：仅需提交数据，无需复杂计算。
> - **开发门槛低**：无需零知识证明（ZKP）专业知识。
>
>  **缺点**
>
> - **提款延迟**：用户需等待挑战期结束（7天）才能提取资金。
> - **中心化风险**：依赖排序器（Sequencer）快速打包交易。
> - **安全依赖诚实多数**：若无人监控并提交欺诈证明，恶意交易可能通过。
>
>  **代表项目**
>
> - **Optimism**、**Arbitrum**（EVM 兼容，主打 DeFi 生态）。
>
> ------
>
>  **2. ZK Rollup（零知识证明汇总）**
>
> **核心思想**
>
> “数学证明，即时验证” —— 每批交易通过零知识证明（ZKP）验证有效性，无需争议期。
>
> **工作流程**
>
> 1. **交易打包**：
> 	- 排序器收集交易，生成状态变更和有效性证明（ZK-SNARK/STARK）。
> 	- 将证明和状态根提交到主链。
> 1. **链上验证**：
> 	- 主链验证 ZKP，确保交易合法后立即更新状态。
> 	- 无需挑战期，交易即时确认。
>
> **优点**
>
> - **即时最终性**：无提款延迟，资金可立即提取。
> - **更高安全性**：依赖数学证明，无需诚实多数假设。
> - **隐私性**：可选择性隐藏交易细节（如 Zcash 风格隐私交易）。
>
> **缺点**
>
> - **计算资源消耗大**：生成 ZKP 需要高性能硬件。
> - **EVM 兼容性有限**：早期仅支持简单逻辑，现逐步改进（如 zkEVM）。
> - **开发复杂度高**：需密码学专业知识。
>
> **代表项目**
>
> - **zkSync**、**StarkNet**、**Scroll**（专注 zkEVM 兼容）。



以太坊生态可以分为以下几个层次：

1. **应用层（Application Layer）**

用户直接交互的应用和界面：

- **DeFi 应用**：Uniswap（去中心化交易所）、Aave（借贷协议）、Compound（借贷协议）
- **NFT 平台**：OpenSea、Foundation、SuperRare
- **钱包应用**：MetaMask、Coinbase Wallet、Rainbow
- **DAO 工具**：Snapshot、Aragon、Colony

2. **协议层（Protocol Layer）**

以太坊的核心基础设施：

- **共识层客户端**：Prysm、Lighthouse、Nimbus、Teku
- **执行层客户端**：Geth、Nethermind、Erigon、Besu
- **核心协议**：EVM、状态管理、Gas 机制

3. **扩展层（Scaling Layer）**

提升性能和降低成本的解决方案：

- **Layer 2 Rollups**：Arbitrum、Optimism、Polygon zkEVM、zkSync Era
- **侧链**：Polygon PoS、xDAI（Gnosis Chain）
- **状态通道**：Lightning Network for Ethereum



### 以太坊文化与价值观

核心价值观

1. **去中心化治理（Decentralization）**
	- 没有单一的控制者或权威机构
	- 社区通过公开讨论和 EIP（以太坊改进提案）机制共同决策
	- 验证者遍布全球，防止权力集中
1. **无需许可与开放性（Permissionless & Open）**
	- 任何人都可以使用、开发、部署智能合约
	- 开源代码，透明可审计
	- 无身份、地域、财富限制的参与门槛
1. **抗审查性（Censorship Resistance）**
	- 交易和智能合约不受政府或机构干预
	- 通过分布式验证确保网络弹性
	- 支持言论自由和经济自由
1. **密码朋克精神（Cypherpunk Ethos）**
	- 代码即法律：用算法和数学构建信任
	- 密码学保护隐私和自主权
	- 技术驱动的社会变革，而非政治手段
1. **公共物品导向（Public Goods Orientation）**
	- 优先考虑生态系统整体利益
	- 支持开源项目和基础设施建设
	- 通过各种资助计划推动创新
1. **可持续发展理念**
	- The Merge 体现了对环境责任的承诺
	- 长期主义思维，注重技术的可持续演进
	- 平衡创新速度与网络稳定性



### 以太坊核心机制：从账户到执行的完整链路

以太坊三个关键机制：**账户系统**、**Gas 模型** 和 **以太坊虚拟机（EVM）**。

（1）账户系统：你的数字身份

**账户系统** 包含由私钥控制的 **外部账户（EOA）** 和由智能合约代码控制的 **合约账户（CA）** 。

想象你第一次接触以太坊——你需要一个“数字钱包”来参与网络。这个钱包的核心是 **外部账户（EOA）** ，它由一对密钥（私钥和公钥）生成，就像银行账户的密码和账号。私钥是你控制账户的“钥匙”，必须严格保密；公钥通过加密算法生成一个唯一的地址（如 `0xAbc...123`），你可以把它分享给朋友接收转账。

除了用户控制的 EOA，还有 **合约账户（CA）** 。它们不像 EOA 那样受私钥控制，而是由代码驱动。比如，你部署一个智能合约（如一个 NFT 市场），区块链会自动生成一个 CA 地址（如 `0xDef...456`）。这个账户不能主动发起交易，只能通过 EOA 触发——比如你点击“购买 NFT”按钮时，EOA 向 CA 发送交易，CA 的代码自动执行出货逻辑。

每个账户都包含四个关键字段：

- **Nonce**：防止重复交易的计数器（EOA 记录发送次数，CA 记录创建合约次数）。
- **余额**：账户持有的 ETH 数量（单位为 Wei）。
- **CodeHash**：EOA 为空哈希，CA 存储合约字节码的哈希值。
- **StorageRoot**：记录账户数据的 Merkle 树根哈希（如 NFT 归属关系）。

（2）Gas 模型：交易的燃料费

当你用钱包使用自己的 EOA 发起一笔交易（比如转账或操作合约），这件事当然 **不会是免费的**，你需要支付“燃料费”——也就是 **Gas**。

Gas 费用 = **用多少 × 每单位多少钱**，就像你打车一样：

- **Gas Limit（限额）**：你最多愿意“烧”多少燃料。 比如你觉得最多可能需要 15 万单位，就设置 150,000。
- **Gas Price（单价）**：每单位燃料多少钱，用 Gwei 表示（1 Gwei = 0.000000001 ETH）。 网络越拥堵，价格越贵，就像打车高峰期加价。

所以，**总费用 = Gas Limit × Gas Price**。

```
假设你设置 Gas Limit 为 150 000，Gas Price 为 100 Gwei，总费用就是 0.015 ETH。如果实际消耗 120 000 Gas，剩余 30 000 Gas × 100 Gwei = 0.003 ETH 会退还给你。
```

Gas 的存在有两个目的：

- **激励矿工/验证者**：你给得越多（Gas Price 越高），他们越愿意优先处理你的交易。
- **防止资源滥用**：如果有人想让合约死循环，Gas 会用光，交易失败，系统不会被拖垮。

<u>在 EIP-1559 升级后，Gas Price 被拆分了：</u>

以前，Gas Price 全部给矿工。 现在，分成两部分：

- **基础费用（Base Fee）**：每个区块都会有，自动计算，直接销毁（直接消失）来帮助 ETH 通缩，毕竟物以稀为贵。
- **小费（Tip）**：你额外加的钱，用来鼓励矿工优先处理你。

（3）以太坊虚拟机（EVM）：代码的执行引擎

EVM（Ethereum Virtual Machine）是 **以太坊的“大脑”**，是专门用来**运行智能合约的虚拟计算机**。它运行在每个节点上，确保整个网络在处理代码时，**结果都一致、可信任**。

EVM 的核心特点：

- **图灵完备**：就像真正的电脑一样，EVM 可以执行各种逻辑，比如 if 判断、循环等。
- **全球同步**：每个矿工/节点都会自己执行一遍合约代码，保证结果一样。
- **隔离安全**：EVM 把合约“关”在一个小房间里运行，不允许它乱访问用户的数据和网络，保护隐私和安全。





## unphishable钓鱼攻防挑战

挑战地址：[unphishable.io](http://unphishable.io/) 

### 初级

### No.0x0001 Web3 钱包设置指南

第一关就是创建一个MetaMask的小狐狸钱包，在这之前我就有一个钱包里。这关也重点强调了助记词的重要性。非常重要！！千万不能泄露，接下来一关我就中招了！

安全存储助记词方法附上：

- 将其写在纸上（多份副本）
- 存放在安全、防水、防火的地方
- 考虑使用金属备份解决方案以提高耐久性
- 切勿以数字方式存储（不要拍照、不要云存储、不要电子邮件）
- 切勿与任何人分享，包括"支持人员"

还有一个点就是要领取Holesky的测试币，找了几个水龙头都不是很好弄，看群里的小伙伴都是用Google水龙头领测试币，但是我的就用不了，Google的水龙头搞抽象，无法领取，问了群里大佬说他是这样的。不过最后找到一个好用的水龙头，不仅之前领了Sepolia的测试币，现在也领了Holesky的测试币，附上地址

https://www.alchemy.com/faucets/ethereum-sepolia

但是应该是需要eth主网上有一定量的以太币（0.001 ETH）才能在这里领测试币

领完测试币，连接钱包，这关就结束了



### No.0x0002 钱包恢复助手

这是一个ai对话界面，功能是钱包恢复，然后让你输入你的助记词，我看到了这样的字样 “请放心，这是一个安全的环境，您的信息将被加密处理。”然后还真的去找了我的助记词给他添上了，我还特意用ai查了这个平台是否靠谱，结果输入进入，告诉我我被钓鱼了。身为一个学安全的人，我自认为安全意识还是有点的，但是也可能是我还没意识到这个挑战是在做个什么，所以被骗+1。

所以！！永远不要向任何人透露您的助记词，无论他们声称是谁



### No.0x0003 USDC Permit 钓鱼模拟

这一个内容就到了我要学习的地方，之前没听过。开始学！

因为一开始还不知道所以还是点了授权，被骗+1

> 知识点：
>
> **通过使用 EIP-2612 的 `permit` 签名功能**，用户可以在不预先进行链上授权交易（即无需支付 Gas 费）的情况下，授权第三方合约使用自己的代币（如 USDC、DAI 等）。这是以太坊上一种更高效、更省 Gas 的授权方式，尤其适合优化用户体验（UX）和批量操作。
>
> **1. EIP-2612 `permit` 的核心机制**
>
> **（1）传统授权（`approve`）的问题**
>
> - 需要发送一笔链上交易（支付 Gas）。
> - 用户必须提前授权，导致交互流程变长。
>
>  **（2）`permit` 的改进**
>
> ✅ **免 Gas 授权**：用户签署一条链下消息（签名），第三方合约可凭此签名直接获得代币使用权，无需用户预先发送 `approve` 交易。
> ✅ **单次有效**：签名可设置过期时间（`deadline`），避免长期风险。
> ✅ **兼容 ERC-20**：无需修改代币标准，只需代币合约实现 `permit` 函数。
>
>  **2. `permit` 的工作原理**
>
>  **（1）用户签署离线消息**
>
> 用户对以下数据进行签名（使用 EIP-712 结构化签名）：
>
> ```solidity
> {
>   owner: "0x用户地址",       // 代币持有者
>   spender: "0x合约地址",    // 被授权方（如 Uniswap）
>   value: 1000000,          // 授权数量（如 1 USDC = 1e6）
>   nonce: 123,              // 防止重放攻击
>   deadline: 1698765432     // 过期时间（UNIX 时间戳）
> }
> ```
>
>  **（2）第三方合约提交签名**
>
> 合约调用代币的 `permit` 方法，传入签名数据：
>
> ```solidity
> token.permit(owner, spender, value, deadline, v, r, s);
> ```
>
> - `v, r, s` 是签名的 ECDSA 参数。
> - 代币合约验证签名，并更新授权状态（相当于执行了 `approve`）。
>
>  **3. 安全注意事项**
>
>  **✅ 优点**
>
> - **节省 Gas**：用户只需签一次名，无需单独发 `approve` 交易。
> - **更短交互流程**：适合钱包内直接签名授权。
>
>  **⚠️ 风险**
>
> - **签名钓鱼**：恶意 DApp 可能诱导用户签署高额 `permit`（检查 `value` 和 `spender`）。
> - **过期时间失效**：若 `deadline` 过长，签名可能被重复使用（建议设置较短有效期）。

我的理解就是 授权第三方合约使用自己的代币，然后可以省去gas费用

这个签名将允许攻击者控制您的 USDC 代币！通过使用 EIP-2612 permit 签名，攻击者可以：

- 获得对您所有 USDC 的完全访问权限
- 在未来任何时间转移您的代币
- 无需您进一步批准即可花费您的资金

安全检查要点

- 检查 Permit 类型，了解授权范围

- 验证 Spender 地址是否为可信来源

- 注意授权金额，警惕无限制授权

- 确认网站来源的可信度

所以此处不能进行授权



### No.0x0004 专属代币空投

此交易实际上是向合约 0xbe535a82f2c3895bdaceb3ffe6b9b80ac2f832a0 发送 0.5 ETH，而不是领取任何代币。

函数选择器 0x5fba79f5 调用了一个名为 SecurityUpdate() 的函数，该函数可能会将您的资金转移给攻击者。

**在真实情况下，永远不要在不了解交易内容的情况下签署交易！**



### No.0x0005 USDT 授权钓鱼模拟

挑战：请小心真实的授权请求

 **授权风险提示：**

- 除了 approve 外，也要当心 increaseAllowance 函数
- increaseAllowance 同样可以增加代币授权额度
- 一些钓鱼网站会通过这个方式来掩饰其真实意图

💡 安全建议：永远不要给不明来源的网站无限授权！

> `increaseAllowance` 是 **ERC-20 代币标准** 中的一个扩展函数，用于**安全地增加**某个地址（`spender`）的代币授权额度。它是对传统 `approve` 方法的改进，旨在避免潜在的安全风险（如前端竞态条件攻击）。
>
> **传统 `approve` 的问题**
>
> - **竞态条件（Race Condition）**
> 	如果用户连续发起两笔 `approve` 交易（例如先授权 100，再改为 200），矿工可能以相反顺序打包交易，导致最终授权额度被意外覆盖（变成 100 而非 200）。
>
> 	solidity
>
> 	```
> 	// 危险操作：可能被覆盖
> 	approve(spender, 100);  // 交易1
> 	approve(spender, 200);  // 交易2
> 	```
>
>  **`increaseAllowance` 的解决方案**
>
> ✅ **增量调整**：基于当前授权额度增加数值，而非直接覆盖。
> ✅ **安全操作**：避免竞态条件，适合前端交互。



### No.0x0006 假冒代币空投钓鱼攻击

挑战：识别真假域名

- 场景描述

某天，你收到一封电子邮件，声称你有资格获得UNI代币的空投！邮件中包含一个链接，引导你到一个看似合法的网站。你点击了该链接，并看到以下交易记录：

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20144514.png" style="zoom:67%;" />

仔细观察上面的交易记录。这种钓鱼攻击通常利用视觉上相似的字符（如用数字"1"替代字母"i"）来欺骗用户。

**安全建议**

- 始终逐字符检查域名
- 警惕使用数字代替字母的域名（例如，用'1'代替'i'）
- 收藏官方网站而不是点击电子邮件中的链接
- 使用密码管理器，它只会在合法域名上自动填充
- 安装警告钓鱼网站的浏览器扩展



### No.0x0007 超高收益质押平台

挑战：了解如何识别可疑的质押合约

某些可疑的质押合约可能会引导您进行 **approve** 授权，表面上看似只为了质押特定金额，实际上却请求对整个代币余额的完全访问权限。一旦授权成功，攻击者即可任意转走您的所有资产。

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20145026.png" style="zoom:67%;" />

如上图，存在approve方法需要谨慎！！

> `approve` 是 **ERC-20 代币标准** 中的一个核心方法，用于授权另一个地址（通常是智能合约）代表你支配一定数量的代币。它是 DeFi（去中心化金融）交互的基础，但错误使用可能导致资金风险。



### No.0x0008 Telegram 代币钓鱼挑战

挑战：学习识别和避免 Telegram 上的助记词钓鱼攻击

风险点依旧是提供助记词，所以千万不要给别人提供自己钱包的助记词！！！

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20145933.png" style="zoom:67%;" />



### No.0x0009 Punycode 钓鱼攻击

挑战：识别 Punycode 钓鱼域名

- 场景描述

您收到一封电子邮件，声称是来自 Trezor（一个知名的硬件钱包品牌）的重要安全更新通知。电子邮件中的链接看起来像是指向官方 Trezor 网站，但实际上是一个精心伪装的钓鱼网站。

```
trẹzor.com
看起来像正常的 Trezor 域名
```

> #### 什么是 Punycode？
>
> Punycode 是一种编码系统，允许将非 ASCII 字符（如西里尔字母、中文等）转换为 ASCII 字符，以便在域名系统中使用。攻击者经常利用视觉上相似的字符创建看似合法的域名。 例如，某些特殊字符看起来与拉丁字母几乎相同，但它们是不同的字符： 你可以使用 [Punycoder](https://www.punycoder.com/) 来转换 Unicode 和 Punycode 域名。
>
> | 显示域名   | 实际 Punycode 域名 | 说明                       |
> | :--------- | :----------------- | :------------------------- |
> | trẹzor.com | xn--trzor-o51b.com | 使用特殊字符替换了某些字母 |

所以 trezor的官方域名应该为trezor.io

防御方式：

- 直接在浏览器中输入已知的官方网址，而不是点击电子邮件中的链接
- 使用书签保存常用的重要网站
- 安装可以检测 Punycode 域名的浏览器扩展
- 注意域名中不寻常的字符或拼写



### No.0x0010 剪贴板钓鱼挑战

挑战：识别剪贴板型钓鱼攻击

- 场景描述

您需要转账 1 ETH 到朋友的钱包。他们已经分享了他们的钱包地址，您正在使用加密货币转账界面进行转账。

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20150754.png" style="zoom:50%;" />



复制粘贴之后，发现钱包地址与之前的不同了

- 攻击原理：

1. 攻击者创建一个看似合法的网站
1. 当你点击"复制"按钮时，恶意JavaScript代码会秘密替换复制的地址
1. 如果粘贴后没有验证地址，你可能会将资金发送给攻击者

- 防御方式：

	- 粘贴后务必再次检查地址

	- 考虑使用带有地址验证的硬件钱包

	- 在电脑上复制敏感信息（如钱包地址）时要特别小心 - 即使使用Ctrl+C，恶意软件也可能篡改你的剪贴板内容



### No.0x0011 Google 搜索广告钓鱼攻击

挑战：识别 Google 搜索广告钓鱼

- 场景描述

您想要使用 Lido Finance 质押 ETH。在 Google 上搜索"Lido Finance"时看到这些结果。您能识别出哪个是合法网站，哪个是钓鱼网站吗？

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20151348.png" style="zoom:67%;" />

看第一条的左上角有一个Ad，是广告的意思，怀疑是钓鱼网站

辨别网站真伪的方法：

- 攻击者经常购买与热门加密货币项目相关的 Google 广告，这些广告会出现在搜索结果的顶部，标记为"赞助"或"广告"。
- 这些广告通常使用与官方网站非常相似的域名，但有细微的差别，例如：
	-  使用不同的顶级域名（如用 .is 代替 .fi）
	-  在域名中添加或删除字母
	-  使用连字符或用数字替换字母
	-  当用户点击这些广告时，他们会被引导到看起来与官方网站完全相同的钓鱼网站，这些网站旨在窃取资金或私钥。



### No.0x0012 Microsoft Teams 钓鱼攻击

本页面模拟攻击者如何创建虚假的 Microsoft Teams 网站来分发恶意软件和窃取敏感信息。

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20151843.png" style="zoom:67%;" />

本示例中的钓鱼指标

- **可疑 URL**：注意域名是 "microsoft-meet.com" 而不是 "teams.microsoft.com"
- **简化界面**：与真实的 Teams 登录相比，虚假页面具有简化的界面
- **缺乏安全功能**：缺少 Microsoft 通常包含的安全元素
- **加入按钮**：突出的 "在 Teams 应用程序中加入" 按钮可能会导致恶意软件下载

安全提示

- 在输入凭据或下载软件之前，始终验证 URL。
- 仅从官方 Microsoft 网站或应用商店下载 Microsoft Teams。
- 对任何异常的安装过程或请求保持警惕。
- 如果您下载了可疑的软件包，可以在打开之前使用 [VirusTotal.com](https://www.virustotal.com/) 进行扫描。但请注意，即使没有检测到威胁（0 检测），也不能保证绝对安全。



> ## Microsoft Teams 钓鱼攻击的工作原理
>
> 攻击者创建令人信服的 Microsoft Teams 登录页面或更新通知的复制品，诱骗用户下载恶意软件或泄露其凭据。这些攻击变得越来越复杂，针对个人和组织。
>
> 风险1：数据泄露
>
> 通过虚假 Teams 更新安装的恶意软件可以访问您设备上的敏感文件，可能导致未经授权访问个人和公司数据。这可能导致知识产权盗窃、机密信息泄露和合规违规。
>
> 风险2：凭据盗窃
>
> 当用户在虚假 Teams 网站上输入其 Microsoft 凭据时，攻击者会捕获这些信息以获取对电子邮件、OneDrive、SharePoint 和其他 Microsoft 365 服务的访问权限。这可能导致账户被接管并进一步危及组织资源。
>
> 风险3：钱包资金耗尽
>
> 对于从同一设备访问加密货币钱包或金融服务的用户，通过虚假 Teams 更新安装的恶意软件可能包含扫描钱包凭据的功能，导致数字资产被盗。



### No.0x0037 虚假扩展程序钓鱼

挑战：识别出虚假扩展程序

<img src="https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-05%20155308.png" style="zoom: 50%;" />

扩展程序安全最佳实践：

- 始终从官方网站下载：直接访问官方网站（例如 metamask.io），而不是在扩展商店中搜索。虚假或恶意扩展程序可能出现在搜索结果中，甚至出现在官方扩展商店中，有时会模仿真实扩展程序的名称、图标或品牌。通过访问官方网站，您可以确保获得正宗、安全的版本，避免落入可能危及您安全和资产的仿冒或诈骗列表的陷阱。
- 检查用户数量和评论：官方扩展程序拥有大量用户和普遍积极的评论
- 仔细阅读权限：只授予必要的权限
- 保持扩展程序更新：定期更新通常包含安全补丁
- 删除未使用的扩展程序：通过删除不再使用的扩展程序来减少攻击面

# 2025-08-04

# Web3共学

## 区块链基础概念

### 区块链介绍

区块链是一种**去中心化**的**分布式账本**技术，用于在网络节点之间安全、透明且不可篡改地记录事务数据

- 去中心化：区块链网络通常分布在全球，每个节点都将会存储一份相同的区块链数据。没有人能够控制全部的节点，因此这份区块链数据将会一直存在。



### 区块链特性

1. 不可篡改

你无法改变历史信息，因为每个区块包含了上一个区块的摘要并串联起来，如果你修改了历史的区块，你将必须修改后面的全部区块。所以交易一旦上链，就无法再更改

2. 公开透明、匿名

在区块链上的信息全部公开透明。每个人都可以顺着区块和链找到历史上所有的记录来查看你的钱包余额。可以在区块链浏览器上进行查看

3. 快速交易

无论金额多少以及你在什么地方，只要你的交易记录被打包在区块链中，交易就自动完成。相比传统的跨国汇款非常快速便捷



### 区块链的核心组成部分

#### **去中心化的网络和区块链**

区块链将会有一条链来记录全部的信息，这条链将存在对应的去中心化网络中。 去中心化的网络，将由无数节点提供服务来维持网络运行。节点通过计算验证交易获得代币奖励



#### **维持网络运行的代币激励**

去中心化的网络由无数节点提供服务来维持网络运行，整合区块并合并到链上的操作称为**挖矿**。维持这些服务的人一般称之为**矿工**。矿工们维持网络运行会得到代币奖励以及燃料费（Gas Fee）。 你使用这个网络进行交易、转账、铸造 NFT 等等，均需要支付代币



### 公链 私链 联盟链

区块链根据访问权限与治理模式，大致可分为三类。按照去中心化程度从高到低排列

![](https://cdn.jsdelivr.net/gh/xmhhmx/PicGoCDN//img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-04%20205327.png)

####  公链（Public Blockchain）

- **特点**：
	- **完全开放**：任何人可参与读写、验证交易或成为节点。
	- **去中心化**：无单一控制方，数据公开透明，不可篡改。
	- **激励机制**：通常通过代币（如比特币、以太坊）奖励矿工/验证者。
	- **性能较低**：因共识机制（如PoW、PoS）需全局节点验证，交易速度较慢。
- **典型应用**：
	- 加密货币（比特币、以太坊）。
	- 去中心化应用（DApp）、DeFi、NFT等开放生态。
- **代表案例**：
	Bitcoin、Ethereum、Solana。



#### 私链（Private Blockchain）

- **特点**：
	- **权限封闭**：由单一组织或实体控制，参与者需授权。
	- **中心化**：节点由管理者指定，交易验证效率高。
	- **隐私性强**：数据仅对授权方可见，适合企业内部使用。
	- **无代币激励**：通常无需挖矿，节点由组织自行维护。
- **典型应用**：
	- 企业数据管理、内部审计、供应链追踪等。
	- 对隐私和效率要求高的封闭场景。
- **代表案例**：
	Hyperledger Fabric（可配置为私链）、R3 Corda。



#### 联盟链（Consortium Blockchain）

- **特点**：
	- **部分去中心化**：由多个组织联合管理（如银行、企业联盟）。
	- **准入机制**：节点需许可加入，但参与者间平等协作。
	- **平衡效率与信任**：共识机制（如PBFT）比公链更快，兼顾一定透明度。
	- **部分公开**：数据可对成员共享，对外保密。
- **典型应用**：
	- 跨机构业务（跨境支付、贸易金融）。
	- 行业协作（物流、医疗数据共享）。
- **代表案例**：
	Hyperledger Fabric、FISCO BCOS、Quorum。

#### 对比总结

| **维度**     | **公链**            | **联盟链**         | **私链**         |
| :----------- | :------------------ | :----------------- | :--------------- |
| **控制权**   | 无中心主体          | 多组织共同治理     | 单一组织控制     |
| **参与权限** | 完全开放            | 需许可加入         | 严格授权         |
| **透明度**   | 全网公开            | 成员间透明         | 仅内部可见       |
| **性能**     | 低（TPS低，延迟高） | 中（优化共识机制） | 高（中心化处理） |
| **用例**     | 加密货币、开放生态  | 跨机构协作         | 企业内部管理     |

#### 选择依据

- **公链**：适合需要完全去中心化和信任透明的场景。
- **联盟链**：适合多组织协作且需平衡效率与隐私的行业。
- **私链**：适合单一组织追求高效可控的私有化应用。


# 2025.07.30


<!-- Content_END -->
